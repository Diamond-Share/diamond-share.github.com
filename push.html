<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ø—Ä–∞–≤–∏—Ç—å Push</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        input, textarea, button {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus {
            border-color: #007bff;
            outline: none;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }
        
        button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
            font-weight: bold;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            display: block;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
            display: block;
        }
        
        .loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #bee5eb;
            display: block;
        }
        
        .token-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å Push –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h1>
        
        <div class="form-group">
            <label for="token">–¢–æ–∫–µ–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</label>
            <div class="token-display" id="tokenDisplay">druRDN2znjT9oF3gy_-Me2:APA91bHlGKq_Aiqc0PDaOqPqq-IviFrCpU5Mbmlp6Fjvq_ZejFtXxBBMlD82-3QZsz8VhmECo5V3XV0Y9V0wtVcs4-CYMmZZAr7mo_OTvhAcL8WQFwRbyrE</div>
        </div>
        
        <div class="form-group">
            <label for="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</label>
            <input type="text" id="title" value="–ü—Ä–∏–≤–µ—Ç! üëã" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫">
        </div>
        
        <div class="form-group">
            <label for="message">–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</label>
            <textarea id="message" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞! üì±</textarea>
        </div>
        
        <button onclick="sendPush()" id="sendBtn">
            üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å Push –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        </button>
        
        <div id="result" class="result"></div>
        
        <div style="margin-top: 30px; padding: 15px; background: #fff3cd; border-radius: 10px;">
            <h3>üí° –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
            <p>1. –°–æ—Ö—Ä–∞–Ω–∏ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</p>
            <p>2. –û—Ç–∫—Ä–æ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
            <p>3. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–û—Ç–ø—Ä–∞–≤–∏—Ç—å Push –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"</p>
            <p>4. –ü–æ–ª—É—á–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Ç–æ–º –∂–µ —Ç–µ–ª–µ—Ñ–æ–Ω–µ! üì≤</p>
        </div>
    </div>

    <script>
        async function sendPush() {
            const token = 'druRDN2znjT9oF3gy_-Me2:APA91bHlGKq_Aiqc0PDaOqPqq-IviFrCpU5Mbmlp6Fjvq_ZejFtXxBBMlD82-3QZsz8VhmECo5V3XV0Y9V0wtVcs4-CYMmZZAr7mo_OTvhAcL8WQFwRbyrE';
            const title = document.getElementById('title').value || '–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ';
            const message = document.getElementById('message').value || '–ü—Ä–∏–≤–µ—Ç –æ—Ç Firebase!';
            const resultDiv = document.getElementById('result');
            const sendBtn = document.getElementById('sendBtn');
            
            const payload = {
                notification: {
                    title: title,
                    body: message,
                    icon: 'https://skyberry-a31d8.firebaseapp.com/icon.png',
                    click_action: 'https://skyberry-a31d8.firebaseapp.com'
                },
                to: token
            };
            
            try {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                resultDiv.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ...';
                resultDiv.className = 'result loading';
                sendBtn.disabled = true;
                sendBtn.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS proxy –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const targetUrl = 'https://fcm.googleapis.com/fcm/send';
                
                const response = await fetch(proxyUrl + targetUrl, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'key=AIzaSyDvvp3qyBsQsZQfuwaImeZUZ4C0M9I912Q',
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                console.log('–û—Ç–≤–µ—Ç –æ—Ç FCM:', data);
                
                if (data.success === 1 || data.message_id) {
                    resultDiv.textContent = '‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω üì±';
                    resultDiv.className = 'result success';
                } else {
                    resultDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${data.results?.[0]?.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`;
                    resultDiv.className = 'result error';
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                resultDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑.`;
                resultDiv.className = 'result error';
            } finally {
                sendBtn.disabled = false;
                sendBtn.textContent = 'üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å Push –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ';
            }
        }
        
        // –ê–≤—Ç–æ-–æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å)
        setTimeout(() => {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –≥–æ—Ç–æ–≤–æ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
        }, 2000);
    </script>
</body>
    </html>
