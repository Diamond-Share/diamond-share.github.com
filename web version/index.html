<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Diamond Share</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<style>
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  backdrop-filter: blur(5px);
}

.loading-container {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.loading-text {
  font-size: 24px;
  font-weight: 600;
  color: #333;
  font-family: 'Inter', sans-serif;
}

.loading-subtext {
  font-size: 12px;
  color: rgba(0, 0, 0, 0.4);
  margin-top: 5px;
  font-weight: 400;
}

.loading-subtext {
  font-size: 12px;
  color: rgba(0, 0, 0, 0.4);
  margin-top: 5px;
  font-weight: 400;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  opacity: 0.7; /* Слегка прозрачный */
}
</style>
  <!-- ЗАМЕНА НАЧАЛА -->
<!-- ЭКРАН ПРИВЕТСТВИЯ -->
<div class="welcome-screen" id="welcome-screen">
  <div class="welcome-animation">
    <lottie-player 
      src="https://diamond-share.github.io/Welcome.json" 
      background="transparent" 
      speed="1" 
      autoplay
      loop
      style="width: 100%; height: 100%;">
    </lottie-player>
  </div>
  
  <h1 class="welcome-title">Добро пожаловать в Diamond Share</h1>
  <p class="welcome-subtitle">Безопасный обмен файлами и удобное хранение ваших данных</p>
  
  <button class="start-btn" id="startButton">Начать</button>
  
  <p class="policy-text">
    Нажимая на кнопку начать, вы соглашаетесь с 
    <a href="policy.html" class="policy-link">условиями пользования</a> и 
    <a href="policy.html" class="policy-link">политикой конфиденциальности</a>
  </p>
</div>
<!-- ЗАМЕНА КОНЦА -->

  <!-- ЗАМЕНА НАЧАЛА -->
<!-- ЭКРАН ВВОДА USERNAME (ЗАМЕНА НА ДИЗАЙН ИЗ LOGI.HTML) -->
<div class="auth-screen" id="username-screen">
  <div class="login-container animate__animated animate__fadeIn">
    <div class="login-header">
      <h1>Введите логин</h1>
      <p>Для входа в вашу учетную запись</p>
    </div>
    
    <div class="login-animation">
      <lottie-player 
        src="https://diamond-share.github.io/login_success.json" 
        background="transparent" 
        speed="1" 
        autoplay
        loop
        style="width: 100%; height: 100%;">
      </lottie-player>
    </div>
    
    <div class="login-form">
      <div class="input-group">
        <input type="text" class="login-input" id="login-username" placeholder="@username" autocomplete="off" required>
        <div class="error-message" id="username-error" style="display: none;"></div>
      </div>
      
      <button class="login-submit-btn" id="login-continue-btn" disabled>
        Далее
      </button>
      
      <div class="login-links">
        <a href="#" class="forgot-link">Забыли логин?</a>
        <a href="#" class="register-link" id="switch-to-register">Нет аккаунта? Зарегистрироваться</a>
      </div>
    </div>
  </div>
</div>
<!-- ЗАМЕНА КОНЦА -->

  <div class="auth-screen" id="password-screen">
  <div class="password-container">
    <div class="header">
      <h1></h1>
      <p id="password-user-login"></p>
    </div>
    
    <div class="animation-container">
      <lottie-player 
        src="https://diamond-share.github.io/Password_Authentication.json" 
        background="transparent" 
        speed="1" 
        autoplay
        loop
        style="width: 100%; height: 100%;">
      </lottie-player>
    </div>
    
    <div class="auth-form">
      <div class="input-group">
        <input type="password" class="input-field" id="login-password" placeholder="Введите ваш пароль" required>
        <button type="button" class="toggle-password" id="togglePassword"></button>
        <div class="error-message" id="password-error"></div>
      </div>
      
      <button type="submit" class="submit-btn" id="login-btn">Войти</button>
      <button type="button" class="back-btn" id="back-to-username">Назад</button>
      
      <a href="#" class="forgot-password">Забыли пароль?</a>
    </div>
  </div>
</div>

  <div class="auth-screen" id="register-screen">
    <div class="auth-container animate__animated animate__fadeIn">
      <div class="auth-header">
        <button class="back-btn" id="back-to-login">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2>Регистрация</h2>
      </div>
      
      <div class="auth-form">
        <div class="input-field animate__animated animate__fadeInUp">
          <i class="fas fa-user"></i>
          <input type="text" id="register-name" placeholder="Ваше имя" autocomplete="off">
          <div class="input-border"></div>
        </div>
        
        <div class="input-field animate__animated animate__fadeInUp animate__delay-1s">
          <i class="fas fa-at"></i>
          <input type="text" id="register-username" placeholder="@username" autocomplete="off">
          <div class="input-border"></div>
        </div>
        
        <div class="input-field animate__animated animate__fadeInUp animate__delay-1-5s">
          <i class="fas fa-lock"></i>
          <input type="password" id="register-password" placeholder="Пароль" autocomplete="off">
          <div class="input-border"></div>
        </div>
        
        <div class="input-field animate__animated animate__fadeInUp animate__delay-2s">
          <i class="fas fa-lock"></i>
          <input type="password" id="register-confirm" placeholder="Подтвердите пароль" autocomplete="off">
          <div class="input-border"></div>
        </div>
        
        <div class="error-message" id="register-error" style="display: none; color: #ff4757; font-size: 14px; margin: 10px 0;"></div>
        
        <button class="auth-btn animate__animated animate__fadeInUp animate__delay-2-5s" id="register-btn">
          Зарегистрироваться
        </button>
        
        <div class="auth-footer animate__animated animate__fadeIn animate__delay-3s">
          <p>Уже есть аккаунт? <a href="#" id="switch-to-login">Войти</a></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main app -->
  <div id="app" style="display: none;">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-share-alt"></i>
        </div>
        <span>Diamond Share</span>
      </div>
      <div class="header-actions">
        <div class="user-avatar" id="user-avatar">
          <span id="user-avatar-text">U</span>
        </div>
      </div>
    </div>
    
    <div class="search-container" id="search-container" style="display: none;">
  <div class="search-header">
    <button class="back-btn" id="search-back-btn">
      <i class="fas fa-arrow-left"></i>
    </button>
    <div class="search-input-wrapper">
      <i class="fas fa-search"></i>
      <input type="text" id="search-input" placeholder="Поиск пользователей..." autocomplete="off">
      <button class="clear-search" id="clear-search" style="display: none;">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>
  <div class="search-results" id="search-results">
    <!-- Кнопка создания группы будет добавляться сюда автоматически -->
    <div class="search-empty-state">
      <i class="fas fa-search"></i>
      <p>Введите имя пользователя для поиска</p>
    </div>
  </div>
</div>

    <div class="main-content">
      <div class="chats-list" id="chats-list">
        <div class="empty-state">
          <div class="empty-icon">
            <i class="fas fa-comments"></i>
          </div>
          <div class="empty-title">Нет чатов</div>
          <p>Добавьте контакты, чтобы начать общение</p>
        </div>
      </div>

      <div class="chat-view" id="chat-view">
        <div class="chat-header">
  <div class="chat-header-content">
    <button class="back-btn" id="back-btn">
      <i class="fas fa-arrow-left"></i>
    </button>
    <div class="chat-header-avatar" id="chat-header-avatar">
      <span id="chat-header-avatar-text">C</span>
    </div>
    <div class="chat-header-info">
      <div class="chat-title-wrapper">
        <div class="chat-title" id="chat-title">Чат</div>
      </div>
      <div class="chat-status" id="chat-status"></div>
    </div>
  </div>
  <div class="chat-header-actions">
    <button class="chat-action-btn" id="chat-info-btn">
      <i class="fas fa-info-circle"></i>
    </button>
  </div>
</div>
        <div class="messages-container">
          <div class="messages" id="messages"></div>
          <div class="typing-indicator" id="typing-indicator" style="display: none;">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        </div>
        <div class="input-area">
          <button class="attachment-btn" id="attachment-btn">
            <i class="fas fa-paperclip"></i>
          </button>
          <div class="attachment-menu" id="attachment-menu">
            <div class="attachment-option" id="attach-sticker">
              <i class="fas fa-sticky-note"></i>
              <span>Стикер</span>
            </div>
          </div>
          <div class="upload-preview" id="upload-preview">
            <div class="upload-preview-header">
              <div class="upload-preview-title">Отправить файл</div>
              <button class="upload-preview-close" id="upload-preview-close">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="upload-preview-content" id="upload-preview-content"></div>
            <div class="upload-preview-actions">
              <button class="btn btn-secondary" id="cancel-upload">Отмена</button>
              <button class="btn btn-primary" id="send-upload">Отправить</button>
            </div>
          </div>
          <button class="emoji-btn" id="emoji-btn">
            <i class="far fa-smile"></i>
          </button>
          <div class="message-input-container">
            <textarea class="message-input" id="message-input" placeholder="Сообщение..." rows="1"></textarea>
          </div>
          <button class="send-btn" id="send-btn" disabled>
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="bottom-nav">
      <div class="nav-item active" data-screen="chats">
        <div class="nav-icon"><i class="fas fa-comment-dots"></i></div>
        <div class="nav-text">Чаты</div>
      </div>
      <div class="nav-item" data-screen="contacts">
        <div class="nav-icon"><i class="fas fa-user-friends"></i></div>
        <div class="nav-text">Контакты</div>
      </div>
      <div class="nav-item" data-screen="settings">
        <div class="nav-icon"><i class="fas fa-cog"></i></div>
        <div class="nav-text">Настройки</div>
      </div>
    </div>
  </div>

  <div class="settings-screen" id="settings-screen">
    <div class="settings-header">
      <button class="settings-back-btn" id="settings-back-btn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="settings-title">Профиль</div>
      <button class="settings-qr-btn" id="settings-qr-btn">
        <i class="fas fa-qrcode"></i>
      </button>
    </div>
    
    <div class="settings-profile">
      <div class="settings-avatar" id="settings-avatar">
        <img id="settings-avatar-img" src="" alt="Avatar">
        <span id="settings-avatar-text">U</span>
      </div>
      <div class="settings-name" id="settings-profile-name">
        Имя пользователя
        <span class="verified-badge">
          <lottie-player 
            src="https://diamond-share.github.io/verification.json" 
            background="transparent" 
            speed="1" 
            autoplay
            loop
            style="width: 26px; height: 26px;">
          </lottie-player>
        </span>
      </div>
      <div class="settings-username" id="settings-profile-username">@username</div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">Учётная запись</div>
      <div class="tiles-container">
        <div class="settings-tile" id="notifications-settings-btn">
          <div class="tile-icon"><i class="fas fa-bell"></i></div>
          <div class="tile-text">Уведомления</div>
        </div>
        <div class="settings-tile" id="privacy-settings-btn">
          <div class="tile-icon"><i class="fas fa-lock"></i></div>
          <div class="tile-text">Приватность</div>
        </div>
        <div class="settings-tile" id="appearance-settings-btn">
          <div class="tile-icon"><i class="fas fa-palette"></i></div>
          <div class="tile-text">Оформление</div>
        </div>
        <div class="settings-tile" id="help-settings-btn">
          <div class="tile-icon"><i class="fas fa-question-circle"></i></div>
          <div class="tile-text">Помощь</div>
        </div>
      </div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">О приложении</div>
      <div class="settings-item">
        <div class="settings-item-text">Версия приложения</div>
        <div class="settings-item-text">2.6</div>
      </div>
      <div class="settings-item">
        <div class="settings-item-text">Разработчик</div>
        <div class="settings-item-text">StarPriks Company</div>
      </div>
    </div>
    
    <div class="settings-tile" onclick="showPreferences()">
      <div class="tile-icon"><i class="fas fa-heart"></i></div>
      <div class="tile-text">Предпочтения</div>
    </div>

    
    <div class="settings-actions">
      <button class="settings-logout-btn" id="settings-logout-btn">
        <i class="fas fa-sign-out-alt"></i> Выйти
      </button>
      <button class="settings-delete-btn" id="settings-delete-btn">
        Удалить профиль
      </button>
    </div>
  </div>

  <div class="settings-screen" id="notifications-screen">
    <div class="settings-header">
      <button class="settings-back-btn" id="notifications-back-btn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="settings-title">Уведомления</div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">Общие настройки</div>
      <div class="notification-item">
        <div class="notification-label">Включить уведомления</div>
        <label class="switch">
          <input type="checkbox" id="notifications-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">Типы уведомлений</div>
      <div class="notification-item">
        <div class="notification-label">Личные чаты</div>
        <label class="switch">
          <input type="checkbox" id="private-chats-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
      <div class="notification-item">
        <div class="notification-label">Группы</div>
        <label class="switch">
          <input type="checkbox" id="groups-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
      <div class="notification-item">
        <div class="notification-label">Каналы</div>
        <label class="switch">
          <input type="checkbox" id="channels-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
      <div class="notification-item">
        <div class="notification-label">Прочие</div>
        <label class="switch">
          <input type="checkbox" id="other-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">Настройки уведомлений</div>
      <div class="notification-item">
        <div class="notification-label">Звук</div>
        <label class="switch">
          <input type="checkbox" id="sounds-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
      <div class="notification-item">
        <div class="notification-label">Вибрация</div>
        <label class="switch">
          <input type="checkbox" id="vibration-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
      <div class="notification-item">
        <div class="notification-label">Подсветка экрана</div>
        <label class="switch">
          <input type="checkbox" id="lights-toggle" checked>
          <span class="slider round"></span>
        </label>
      </div>
    </div>
  </div>

  <div class="settings-screen" id="privacy-screen">
    <div class="settings-header">
      <button class="settings-back-btn" id="privacy-back-btn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="settings-title">Приватность</div>
    </div>
    
    <div class="settings-section">
      <div class="settings-section-title">Кто может...</div>
      <div class="settings-item">
        <div class="settings-item-text">Видеть мой номер телефона</div>
        <select class="settings-select" id="phone-privacy">
          <option value="all">Все</option>
          <option value="contacts">Только контакты</option>
          <option value="none">Никто</option>
        </select>
      </div>
      <div class="settings-item">
        <div class="settings-item-text">Видеть мой статус</div>
        <select class="settings-select" id="status-privacy">
          <option value="all">Все</option>
          <option value="contacts">Только контакты</option>
        </select>
      </div>
    </div>
  </div>

  <div class="settings-screen" id="appearance-screen">
  <div class="settings-header">
    <button class="settings-back-btn" id="appearance-back-btn">
      <i class="fas fa-arrow-left"></i>
    </button>
    <div class="settings-title">Оформление</div>
  </div>
  
  <div class="appearance-content">
    <!-- Секция фонов -->
    <div class="appearance-section">
      <div class="appearance-section-title">Фоны чатов</div>
      <div class="backgrounds-carousel" id="backgrounds-carousel">
        <div class="background-item" data-bg="1.png">
          <img src="background/1.png" alt="Фон 1">
          <div class="background-check">
            <i class="fas fa-check"></i>
          </div>
        </div>
        <div class="background-item" data-bg="2.png">
          <img src="background/2.png" alt="Фон 2">
          <div class="background-check">
            <i class="fas fa-check"></i>
          </div>
        </div>
        <div class="background-item" data-bg="3.png">
          <img src="background/3.png" alt="Фон 3">
          <div class="background-check">
            <i class="fas fa-check"></i>
          </div>
        </div>
        <div class="background-item" data-bg="4.png">
          <img src="background/4.png" alt="Фон 4">
          <div class="background-check">
            <i class="fas fa-check"></i>
          </div>
        </div>
        <div class="background-item" data-bg="5.png">
          <img src="background/5.png" alt="Фон 5">
          <div class="background-check">
            <i class="fas fa-check"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Секция тем -->
    <div class="appearance-section">
      <div class="appearance-section-title">Темы</div>
      <div class="theme-options">
        <div class="theme-option" data-theme="light">
          <div class="theme-preview light">
            <div class="theme-demo">
              <div class="demo-header"></div>
              <div class="demo-messages">
                <div class="demo-message incoming"></div>
                <div class="demo-message outgoing"></div>
              </div>
            </div>
          </div>
          <div class="theme-name">Светлая</div>
        </div>
        <div class="theme-option" data-theme="dark">
          <div class="theme-preview dark">
            <div class="theme-demo">
              <div class="demo-header"></div>
              <div class="demo-messages">
                <div class="demo-message incoming"></div>
                <div class="demo-message outgoing"></div>
              </div>
            </div>
          </div>
          <div class="theme-name">Темная</div>
        </div>
      </div>
    </div>

    <!-- Секция размера сообщений -->
    <div class="appearance-section">
      <div class="appearance-section-title">Размер сообщений</div>
      <div class="font-size-controls">
        <button class="font-size-btn" id="font-size-decrease">
          <i class="fas fa-minus"></i>
        </button>
        <div class="font-size-preview">
          <div class="message-preview">
            <div class="preview-bubble">Пример сообщения</div>
          </div>
        </div>
        <button class="font-size-btn" id="font-size-increase">
          <i class="fas fa-plus"></i>
        </button>
      </div>
      <div class="font-size-value" id="font-size-value">
        Средний (100%)
      </div>
    </div>
  </div>
</div>

  <div class="settings-screen" id="help-screen">
    <div class="settings-header">
      <button class="settings-back-btn" id="help-back-btn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="settings-title">Помощь</div>
    </div>
    
    <div class="settings-section">
      <div class="settings-item">
        <div class="settings-item-text">Частые вопросы</div>
        <i class="fas fa-chevron-right"></i>
      </div>
      <div class="settings-item">
        <div class="settings-item-text">Связаться с поддержкой</div>
        <i class="fas fa-chevron-right"></i>
      </div>
    </div>
  </div>

  <div class="qr-modal" id="qr-modal">
    <div class="qr-content">
      <button class="qr-close" id="qr-close">
        <i class="fas fa-times"></i>
      </button>
      <div class="qr-title">Мой QR-код</div>
      <div class="qr-code" id="qr-code">
        QR-код будет здесь
      </div>
      <div class="qr-username" id="qr-username">@username</div>
    </div>
  </div>

  <div class="modal" id="add-chat-modal">
    <div class="modal-content">
      <div class="tabs">
        <div class="tab active" data-tab="contact">Личный чат</div>
        <div class="tab" data-tab="group"></div>
      </div>
      
      <div id="contact-tab-content">
        <h3 class="modal-title">Добавить контакт</h3>
        <input type="text" class="modal-input" id="contact-username" placeholder="@username">
        <div class="modal-actions">
          <button class="btn btn-secondary" id="cancel-add-contact">Отмена</button>
          <button class="btn btn-primary" id="confirm-add-contact">Добавить</button>
        </div>
      </div>
      
      <div id="group-tab-content" style="display: none;">
        <h3 class="modal-title">Создать группу BETA</h3>
        <input type="text" class="modal-input" id="group-name" placeholder="Название группы" required>
        <input type="text" class="modal-input" id="group-members" placeholder="@user1, @user2" required>
        <p class="hint-text">Введите никнеймы участников через запятую</p>
        <div class="modal-actions">
          <button class="btn btn-secondary" id="cancel-create-group">Отмена</button>
          <button class="btn btn-primary" id="confirm-create-group">Создать</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="share-modal">
    <div class="modal-content">
      <h3 class="modal-title">Поделиться профилем</h3>
      <p>Привет! Присоединяйся ко мне в Diamond Share. Мой профиль: <strong id="share-username"></strong></p>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="copy-share-link">
          <i class="fas fa-copy"></i> Копировать
        </button>
        <button class="btn btn-primary" id="share-telegram">
          <i class="fab fa-telegram"></i> Telegram
        </button>
        <button class="btn btn-primary" id="share-whatsapp">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </button>
      </div>
    </div>
  </div>

  <div class="image-preview-modal" id="image-preview-modal">
    <div class="image-preview-content">
      <button class="close-preview" id="close-preview">
        <i class="fas fa-times"></i>
      </button>
      <img id="preview-image" src="" alt="Preview">
    </div>
  </div>

  <div class="modal" id="stickers-modal">
    <div class="modal-content">
      <h3 class="modal-title">Стикеры</h3>
      <div class="stickers-tabs">
        <div class="sticker-tab active" data-pack="panda">Панда</div>
        <div class="sticker-tab" data-pack="cat">Акулёнок</div>
        <div class="sticker-tab" data-pack="dog">Котик</div>
        <div class="sticker-tab" data-pack="bigi">Биги</div>
        <div class="sticker-tab" data-pack="akio">Акио</div>
        <div class="sticker-tab" data-pack="rebi">Реби</div>
        <div class="sticker-tab" data-pack="work">Работяга</div>
        <div class="sticker-tab" data-pack="belka">Белка</div>
      </div>
      <div class="stickers-container" id="stickers-container">
      </div>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="close-stickers">Закрыть</button>
      </div>
    </div>
  </div>

  <div class="message-context-menu" id="message-context-menu">
    <div class="context-menu-item" id="copy-message">
      <i class="fas fa-copy"></i> Копировать
    </div>
    <div class="context-menu-item" id="reply-message">
      <i class="fas fa-reply"></i> Ответить
    </div>
    <div class="context-menu-item" id="forward-message">
      <i class="fas fa-share"></i> Переслать
    </div>
    <div class="context-menu-item" id="delete-message">
      <i class="fas fa-trash"></i> Удалить
    </div>
  </div>

  <div class="forward-modal" id="forward-modal">
    <div class="modal-content">
      <h3 class="modal-title">Переслать сообщение</h3>
      <div class="chats-list" id="forward-chats-list"></div>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="cancel-forward">Отмена</button>
        <button class="btn btn-primary" id="confirm-forward">Отправить</button>
      </div>
    </div>
  </div>

  <div class="custom-modal" id="custom-modal">
    <div class="custom-modal-content">
      <div class="custom-modal-header">
        <h3 class="custom-modal-title" id="custom-modal-title">Title</h3>
        <button class="custom-modal-close" id="custom-modal-close">&times;</button>
      </div>
      <div class="custom-modal-body" id="custom-modal-body">
        Message content
      </div>
      <div class="custom-modal-footer" id="custom-modal-footer">
        <button class="btn btn-secondary" id="custom-modal-cancel">Cancel</button>
        <button class="btn btn-primary" id="custom-modal-confirm">OK</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="avatar-modal">
    <div class="modal-content">
      <h3 class="modal-title">Выберите аватар</h3>
      <div class="avatar-carousel" id="avatar-carousel">
      </div>
      <div class="avatar-carousel-nav" id="avatar-carousel-nav">
      </div>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="cancel-avatar-select">Отмена</button>
        <button class="btn btn-primary" id="confirm-avatar-select">Выбрать</button>
      </div>
    </div>
  </div>
  
  <div id="loading-overlay" class="loading-overlay">
  <div class="loading-container">
    <div class="loading-animation">
      <lottie-player 
        src="https://diamond-share.github.io/loading_1.json" 
        background="transparent" 
        speed="1" 
        autoplay
        loop
        style="width: 390px; height: 390px;">
      </lottie-player>
    </div>
    <div class="loading-text">
      Diamond Share
      <div class="loading-subtext">StarPriks 2025</div>
    </div>
  </div>
</div>
  
  <div class="settings-screen" id="preferences-screen">
    <div class="settings-header">
      <button class="settings-back-btn" onclick="showScreen('settings')">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="settings-title">Мои предпочтения</div>
    </div>
    
    <div class="settings-tile" onclick="showFriendSearch()">
  <div class="tile-icon"><i class="fas fa-users"></i></div>
  <div class="tile-text">Найти друга по интересам</div>
</div>

    <div class="preferences-container">
    <div class="preference-group">
      <label>Любимый цвет</label>
      <select id="pref-color">
        <option value="">Выберите...</option>
        <option>Красный</option><option>Синий</option><option>Зеленый</option>
        <option>Желтый</option><option>Фиолетовый</option><option>Розовый</option>
        <option>Черный</option><option>Белый</option><option>Оранжевый</option>
        <option>Серый</option><option>Бирюзовый</option><option>Бордовый</option>
        <option>Голубой</option><option>Салатовый</option><option>Сиреневый</option>
      </select>
    </div>

    <div class="preference-group">
      <label>Любимый вкус</label>
      <select id="pref-flavor">
        <option value="">Выберите…</option>
        <option>Сладкий</option><option>Солёный</option><option>Кислый</option>
        <option>Горький</option><option>Шоколадный</option><option>Мятный</option>
      </select>
    </div>

    <div class="preference-group">
      <label>Любимый стиль музыки</label>
      <select id="pref-music">
        <option value="">Выберите…</option>
        <option>Поп</option><option>Рок</option><option>Хип-хоп</option>
        <option>Джаз</option><option>Классика</option><option>Электронная</option>
      </select>
    </div>

    <div class="preference-group">
      <label>Любимое время года</label>
      <select id="pref-season">
        <option value="">Выберите…</option>
        <option>Весна</option><option>Лето</option><option>Осень</option><option>Зима</option>
      </select>
    </div>

    <div class="preference-group">
      <label>Любимое хобби</label>
      <select id="pref-hobby">
        <option value="">Выберите…</option>
        <option>Чтение книг</option><option>Спорт</option><option>Рисование</option>
        <option>Путешествия</option><option>Кулинария</option><option>Музыка</option>
      </select>
    </div>

    <button class="btn btn-primary" onclick="savePreferences()">Сохранить</button>
  </div>
  
  <div class="qr-modal" id="qr-modal">
    <div class="qr-content">
      <button class="qr-close" id="qr-close">
        <i class="fas fa-times"></i>
      </button>
      <div class="qr-title">Мой QR-код</div>
      <div class="qr-code" id="qr-code"></div>
      <div class="qr-username" id="qr-username"></div>
      <div class="qr-actions">
        <button class="qr-btn share" onclick="shareQR()">
          <i class="fas fa-share-alt"></i> Поделиться
        </button>
        <button class="qr-btn save" onclick="saveQR()">
          <i class="fas fa-download"></i> Сохранить
        </button>
      </div>
    </div>
  </div>
  
  <div class="friend-search-modal" id="friend-search-modal" style="display: none;">
  <div class="friend-search-container">
    <div class="friend-search-header">
      <button class="friend-search-back" onclick="hideFriendSearch()">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Найти друга по предпочтениям</h2>
    </div>
    
    <div class="friend-search-animation" id="friend-search-animation">
      <div class="searching-icon">
        <div class="searching-person">
          <i class="fas fa-user"></i>
        </div>
        <div class="searching-waves">
          <div class="wave wave-1"></div>
          <div class="wave wave-2"></div>
          <div class="wave wave-3"></div>
        </div>
        <div class="searching-hearts">
          <div class="heart heart-1">❤️</div>
          <div class="heart heart-2">❤️</div>
          <div class="heart heart-3">❤️</div>
        </div>
      </div>
      <div class="searching-text">
        <p>Ищем вам друзей по предпочтениям...</p>
      </div>
    </div>
    
    <div class="fullscreen-animation-modal" id="fullscreen-animation-modal" style="display: none;">
      <div class="fullscreen-animation-content">
        <button class="close-fullscreen-animation" id="close-fullscreen-animation">
          <i class="fas fa-times"></i>
        </button>
        <lottie-player 
          id="fullscreen-animation-player"
          src="https://diamond-share.github.io/verification_good.json" 
          background="transparent" 
          speed="1" 
          autoplay
          loop
          style="width: 100%; height: 100%;">
        </lottie-player>
      </div>
    </div>
    
    <div class="friend-results" id="friend-results" style="display: none;">
      <div class="results-header">
        <h3>Найденные друзья</h3>
        <p>Люди, которые разделяют ваши интересы</p>
      </div>
      
      <div class="results-list" id="results-list">
      </div>
      
      <div class="results-actions">
        <button class="btn btn-secondary" onclick="restartFriendSearch()">
          <i class="fas fa-redo"></i> Искать снова
        </button>
        <button class="btn btn-primary" onclick="hideFriendSearch()">
          <i class="fas fa-check"></i> Готово
        </button>
      </div>
    </div>
  </div>
</div>

  <input type="file" id="avatar-upload-input" accept="image/*" style="display: none;">

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <script src="app.js"></script>
  
  <style>
  .messages-container {
    flex: 1;
    padding: 8px 12px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 2px;
    background-color: var(--chat-bg, #e6ebee);
    background-image: url('pattern.png');
    background-attachment: fixed;
  }

  .message {
    display: flex;
    max-width: 80%;
    margin: 2px 0;
    position: relative;
    transition: all 0.2s ease;
  }

  .message.incoming {
    align-self: flex-start;
    margin-right: auto;
  }

  .message.outgoing {
    align-self: flex-end;
    margin-left: auto;
  }

  .message-meta {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-top: 4px;
    gap: 4px;
  }

  .message-time {
    font-size: 11px;
    opacity: 0.6;
    color: #707579;
  }

  .message.outgoing .message-time {
    font-size: 11px;
    opacity: 0.6;
    color: #707579; 
  }

  .message-status {
    font-size: 11px;
    color: #707579;
  }

  .message-reply {
    padding: 8px 12px 6px 12px;
    background: rgba(0,0,0,0.03);
    border-left: 2px solid var(--primary);
    margin: -4px -12px 6px -12px;
    border-radius: 7.5px 7.5px 0 0;
  }

  .message.outgoing .message-reply {
    background: rgba(0,0,0,0.05);
  }

  .reply-header {
    font-size: 12px;
    font-weight: 500;
    margin-bottom: 2px;
    color: var(--primary);
  }

  .reply-text {
    font-size: 13px;
    opacity: 0.8;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .message-sticker {
    max-width: 180px;
    max-height: 180px;
    border-radius: 8px;
  }

  .input-area {
    padding: 8px 12px;
    background: #f5f5f5;
    border-top: 1px solid #e0e0e0;
    display: flex;
    align-items: flex-end;
    gap: 8px;
    position: relative;
  }

  [data-theme="dark"] .input-area {
    background: #1f1f1f;
    border-color: #333;
  }

  .message-input-container {
    flex: 1;
    background: #ffffff;
    border-radius: 20px;
    padding: 8px 16px;
    min-height: 40px;
    max-height: 120px;
    overflow-y: auto;
  }

  [data-theme="dark"] .message-input-container {
    background: #333;
  }

  .message-input {
    width: 100%;
    border: none;
    background: transparent;
    resize: none;
    outline: none;
    font-family: inherit;
    font-size: 15px;
    line-height: 1.4;
    color: #000;
  }

  [data-theme="dark"] .message-input {
    color: #e0e0e0;
  }

  .typing-indicator {
    display: flex;
    gap: 4px;
    padding: 8px 12px;
    background: rgba(0,0,0,0.05);
    border-radius: 12px;
    align-self: flex-start;
    margin-bottom: 8px;
  }

  [data-theme="dark"] .typing-indicator {
    background: rgba(255,255,255,0.1);
  }

  [data-theme="dark"] .messages-container {
    background-color: #0e1216;
  }
  
  .message-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  
  .message-image:hover {
    transform: scale(1.02);
  }
  
  .image-preview-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  
  .image-preview-content {
    position: relative;
    max-width: 90%;
    max-height: 90%;
  }
  
  .image-preview-content img {
    max-width: 100%;
    max-height: 90vh;
    border-radius: 8px;
  }
  
  .close-preview {
    position: absolute;
    top: -40px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
  }

  [data-theme="dark"] .message.incoming .message-bubble {
    background: #1e2a32;
    color: #e0e0e0;
  }

  [data-theme="dark"] .message.outgoing .message-bubble {
    background: #1d3b26;
  }

  [data-theme="dark"] .message.incoming .message-bubble:before {
    border-color: transparent #1e2a32 transparent transparent;
  }

  [data-theme="dark"] .message.outgoing .message-bubble:before {
    border-color: transparent transparent transparent #1d3b26;
  }
  
  [data-theme="dark"] .message.outgoing .message-bubble {
    background: #1e2a32; 
    color: #e0e0e0;
  }

  [data-theme="dark"] .message.outgoing .message-bubble:before {
    border-color: transparent transparent transparent #1e2a32; 
  }
  

  [data-theme="dark"] .message.outgoing .message-time,
  [data-theme="dark"] .message.outgoing .message-status {
    color: #a0a0a0; 
  }
  
  /* СТИЛИ ДЛЯ ЭКРАНА ПРИВЕТСТВИЯ ИЗ WEL.HTML */
  .welcome-screen {
    width: 100%;
    max-width: 400px;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 20px;
    transition: opacity 0.5s ease;
    position: absolute;
    opacity: 1;
    pointer-events: all;
  }
  
  .welcome-screen.hidden {
    opacity: 0;
    pointer-events: none;
  }
  
  .welcome-animation {
    width: 280px;
    height: 280px;
    margin-bottom: 20px;
  }
  
  .welcome-title {
    font-size: 28px;
    font-weight: 700;
    color: #333;
    margin-bottom: 15px;
  }
  
  .welcome-subtitle {
    font-size: 16px;
    color: #666;
    margin-bottom: 30px;
    line-height: 1.5;
    max-width: 320px;
  }
  
  .start-btn {
    background: #6e8efb;
    color: white;
    border: none;
    border-radius: 15px;
    padding: 18px;
    width: 100%;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 20px;
    box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
  }
  
  .start-btn:hover {
    background: #5a7df9;
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(110, 142, 251, 0.4);
  }
  
  .policy-text {
    font-size: 12px;
    color: #888;
    line-height: 1.4;
    max-width: 300px;
  }
  
  .policy-link {
    color: #6e8efb;
    text-decoration: none;
  }
  
  .policy-link:hover {
    text-decoration: underline;
  }
  
  @media (max-width: 480px) {
    .welcome-animation {
      width: 180px;
      height: 180px;
    }
    
    .welcome-title {
      font-size: 24px;
    }
    
    .welcome-subtitle {
      font-size: 14px;
      margin-bottom: 25px;
    }
    
    .start-btn {
      padding: 16px;
      font-size: 16px;
    }
  }

  .welcome-screen {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      max-width: 400px;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      transition: opacity 0.5s ease;
      opacity: 1;
      pointer-events: all;
  }
  
  #username-screen {
      display: none;
  }
  
  .welcome-screen {
      transition: opacity 0.75s ease;
  }

  .welcome-screen.hidden {
      opacity: 0;
      pointer-events: none;
  }
  
  /* СТИЛИ ДЛЯ НОВОГО ЭКРАНА LOGIN (ИЗ LOGI.HTML) */
.login-container {
  width: 100%;
  max-width: 400px;
  text-align: center;
  padding: 20px;
}

.login-header {
  margin-bottom: 30px;
}

.login-header h1 {
  color: #333;
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 10px;
}

.login-header p {
  color: #666;
  font-size: 16px;
}

.login-animation {
  width: 280px;
  height: 280px;
  margin: 0 auto 30px;
}

.input-group {
  margin-bottom: 25px;
  position: relative;
}

.login-input {
  width: 100%;
  padding: 18px 20px;
  border: 2px solid #e0e0e0;
  border-radius: 15px;
  font-size: 18px;
  transition: all 0.3s;
  outline: none;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

.login-input:focus {
  border-color: #6e8efb;
  box-shadow: 0 0 0 3px rgba(110, 142, 251, 0.2);
}

.login-submit-btn {
  background: #6e8efb;
  color: white;
  border: none;
  border-radius: 15px;
  padding: 18px;
  width: 100%;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.login-submit-btn:hover {
  background: #5a7df9;
}

.login-submit-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
}

.login-links {
  margin-top: 20px;
}

.forgot-link {
  display: block;
  color: #6e8efb;
  text-decoration: none;
  font-size: 16px;
  margin-bottom: 10px;
}

.forgot-link:hover {
  text-decoration: underline;
}

.register-link {
  display: block;
  color: #6e8efb;
  text-decoration: none;
  font-size: 16px;
}

.register-link:hover {
  text-decoration: underline;
}

@media (max-width: 480px) {
  .login-animation {
    width: 220px;
    height: 220px;
  }
  
  .login-header h1 {
    font-size: 24px;
  }
  
  .login-input {
    padding: 16px;
    font-size: 16px;
  }
  
  .login-submit-btn {
    padding: 16px;
    font-size: 16px;
  }
}

/* Стили для экрана пароля как в PSS */
.password-container {
  width: 100%;
  max-width: 400px;
  text-align: center;
  padding: 20px;
}

.password-container .header {
  margin-bottom: 30px;
}

.password-container .header h1 {
  color: #333;
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 10px;
}

.password-container .header p {
  color: #666;
  font-size: 16px;
}

.animation-container {
  width: 280px;
  height: 280px;
  margin: 0 auto 30px;
}

.input-group {
  margin-bottom: 25px;
  position: relative;
}

.input-field {
  width: 100%;
  padding: 18px 20px;
  border: 2px solid #e0e0e0;
  border-radius: 15px;
  font-size: 18px;
  transition: all 0.3s;
  outline: none;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

.input-field:focus {
  border-color: #6e8efb;
  box-shadow: 0 0 0 3px rgba(110, 142, 251, 0.2);
}

.toggle-password {
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  width: 24px;
  height: 24px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23777'%3E%3Cpath d='M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
}

.toggle-password.hide {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23777'%3E%3Cpath d='M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z'/%3E%3C/svg%3E");
}

.submit-btn {
  background: #6e8efb;
  color: white;
  border: none;
  border-radius: 15px;
  padding: 18px;
  width: 100%;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  margin-bottom: 10px;
}

.submit-btn:hover {
  background: #5a7df9;
}

.back-btn {
  background: #f1f1f1;
  color: #666;
  border: none;
  border-radius: 15px;
  padding: 18px;
  width: 100%;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  margin-bottom: 20px;
}

.back-btn:hover {
  background: #e0e0e0;
}

.forgot-password {
  display: block;
  color: #6e8efb;
  text-decoration: none;
  font-size: 16px;
}

.forgot-password:hover {
  text-decoration: underline;
}

@media (max-width: 480px) {
  .animation-container {
    width: 220px;
    height: 220px;
  }
  
  .password-container .header h1 {
    font-size: 24px;
  }
  
  .input-field {
    padding: 16px;
    font-size: 16px;
  }
  
  .submit-btn, .back-btn {
    padding: 16px;
    font-size: 16px;
  }
}

/* Стили для кнопки Назад на экране пароля */
#password-screen .back-btn {
  position: static;
  margin-top: 15px;
  background: #f1f1f1;
  color: #666;
  border: none;
  border-radius: 15px;
  padding: 18px;
  width: 100%;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

#password-screen .back-btn:hover {
  background: #e0e0e0;
}

/* Убедитесь, что контейнер правильно выровнен */
.password-container .auth-form {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

#password-screen .back-btn {
    padding: 18px; /* Такая же высота как у кнопки Войти */
    height: auto; /* Автоматическая высота */
    min-height: 60px; /* Минимальная высота как у кнопки Войти */
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 15px;
    background: #f1f1f1;
    color: #666;
    border: none;
    border-radius: 15px;
    width: 100%;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

/* Убедимся, что кнопка Войти имеет такую же высоту */
#password-screen .submit-btn {
    padding: 18px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Для правильного отображения на мобильных устройствах */
@media (max-width: 480px) {
    #password-screen .back-btn,
    #password-screen .submit-btn {
        padding: 16px;
        min-height: 55px;
        font-size: 16px;
    }
}

#password-screen .back-btn {
    padding: 18px;
    height: auto;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 2px; /* Уменьшили отступ сверху */
    margin-bottom: 10px; /* Добавили отступ снизу */
    background: #f1f1f1;
    color: #666;
    border: none;
    border-radius: 15px;
    width: 100%;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

#password-screen .submit-btn {
    padding: 18px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px; /* Уменьшили отступ снизу */
}

/* Уменьшим общий отступ между элементами формы */
.password-container .auth-form {
    display: flex;
    flex-direction: column;
    gap: 8px; /* Уменьшили расстояние между элементами */
}

@media (max-width: 480px) {
    #password-screen .back-btn,
    #password-screen .submit-btn {
        padding: 16px;
        min-height: 55px;
        font-size: 16px;
        margin-top: 6px;
        margin-bottom: 8px;
    }
    
    .password-container .auth-form {
        gap: 6px;
    }
}

/* Более агрессивное решение - скрываем все лишние элементы */
#password-screen .header,
#password-screen .password-container > .header {
  display: none !important;
  visibility: hidden !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  opacity: 0 !important;
}

/* Анимации переходов между экранами */
.auth-screen {
  transition: opacity 0.3s ease, transform 0.3s ease;
}

/* Анимация перехода вперед (login -> password) */
.auth-screen.slide-out-left {
  opacity: 0;
  transform: translateX(-20px);
}

.auth-screen.slide-in-right {
  opacity: 1;
  transform: translateX(0);
}

/* Анимация перехода назад (password -> login) */
.auth-screen.slide-out-right {
  opacity: 0;
  transform: translateX(20px);
}

.auth-screen.slide-in-left {
  opacity: 1;
  transform: translateX(0);
}

/* Гарантируем, что контейнер занимает всю высоту */
#password-screen {
  overflow: hidden;
}

#password-screen .password-container {
  height: 100vh;
  padding: 0 20px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

/* Стили для скрытия/показа элементов */
.header {
  display: flex;
  transition: opacity 0.3s ease;
}

.header.hidden {
  display: none;
}

.chat-header {
  display: none;
}

.chat-header.hidden {
  display: none;
}

.bottom-nav {
  display: flex;
  transition: opacity 0.3s ease;
}

.bottom-nav.hidden {
  display: none;
}

/* Анимации для плавного перехода */
.chat-view {
  transition: all 0.3s ease;
}

/* Убедитесь, что чат занимает всю высоту при открытии */
.chat-view.fullscreen {
  height: 100vh;
  margin-bottom: 0;
}

/* Стили для полноэкранного режима чата */
.chat-view.fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    background: var(--bg);
}

/* Убедитесь, что контейнер сообщений занимает всю высоту */
.chat-view.fullscreen .messages-container {
    height: calc(100% - 120px);
}

/* Убедитесь, что заголовок чата фиксирован */
.chat-header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: var(--card);
}

/* Стили для кнопки назад в чате */
.chat-header-content {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
}

#back-btn {
  width: 40px;
  height: 40px;
  min-width: 40px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.1);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  margin: 0;
  padding: 0;
}

#back-btn:hover {
  background: rgba(0, 0, 0, 0.15);
  transform: scale(1.05);
}

#back-btn i {
  font-size: 18px;
  color: var(--text);
}

.chat-header-info {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 0;
}

.chat-header-avatar {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
}

.chat-header-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

.chat-header-text {
  flex: 1;
  min-width: 0;
}

.chat-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-status {
  font-size: 13px;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-action-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-secondary);
}

.chat-action-btn:hover {
  background: rgba(0, 0, 0, 0.05);
  color: var(--text);
}

/* Для темной темы */
[data-theme="dark"] #back-btn {
  background: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] #back-btn:hover {
  background: rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .chat-action-btn:hover {
  background: rgba(255, 255, 255, 0.05);
}

/* Стили для новой шапки чата */
.chat-header {
  background-color: var(--card);
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  z-index: 10;
  position: sticky;
  top: 0;
}

.chat-header-content {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

#back-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  margin: 0;
  padding: 0;
  min-width: auto;
}

#back-btn:hover {
  background: rgba(0,0,0,0.1);
  transform: scale(1.05);
}

#chat-header-avatar {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
}

#chat-header-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

.chat-header-info {
  flex: 1;
  min-width: 0;
}

.chat-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-status {
  font-size: 13px;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-action-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-secondary);
}

.chat-action-btn:hover {
  background: var(--hover);
  color: var(--text);
}

/* Для темной темы */
[data-theme="dark"] #back-btn {
  background: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] #back-btn:hover {
  background: rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .chat-action-btn:hover {
  background: rgba(255, 255, 255, 0.05);
}

:root {
  --primary: #3b82f6;
  --primary-dark: #2563eb;
  --bg: #f8fafc;
  --card: #ffffff;
  --text: #1e293b;
  --text-secondary: #64748b;
  --border: #e2e8f0;
  --hover: rgba(0,0,0,0.05);
}

[data-theme="dark"] {
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --bg: #0f172a;
  --card: #1e293b;
  --text: #f8fafc;
  --text-secondary: #94a3b8;
  --border: #334155;
  --hover: rgba(255,255,255,0.05);
}

/* Стили для новой шапки чата */
.chat-header {
  background-color: var(--card);
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  z-index: 10;
  position: sticky;
  top: 0;
}

.chat-header-content {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

#back-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  margin: 0;
  padding: 0;
  min-width: auto;
}

#back-btn:hover {
  background: rgba(0,0,0,0.1);
  transform: scale(1.05);
}

#chat-header-avatar {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
}

#chat-header-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

.chat-header-info {
  flex: 1;
  min-width: 0;
}

.chat-title-wrapper {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 2px;
  flex-wrap: wrap;
}

.chat-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.verified-badge {
  display: inline-flex;
  align-items: center;
  margin-left: -2px;
}

.verified-badge lottie-player {
  width: 20px !important;
  height: 20px !important;
  margin: 0 !important;
}

.chat-status {
  font-size: 13px;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.2;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-action-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-secondary);
}

.chat-action-btn:hover {
  background: var(--hover);
  color: var(--text);
}

/* Для темной темы */
[data-theme="dark"] #back-btn {
  background: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] #back-btn:hover {
  background: rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .chat-action-btn:hover {
  background: rgba(255, 255, 255, 0.05);
}

.chat-name-wrapper {
  display: flex;
  align-items: center;
  gap: 6px;
}

.chat-name-wrapper .verified-badge lottie-player {
  width: 18px !important;
  height: 18px !important;
}

.chat-title {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  min-width: 0;
  flex: 1;
}

.chat-name-wrapper {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.chat-title .chat-status {
  font-size: 13px;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.2;
}

/* Стили для сообщений из center.html */
.messages-container {
  flex: 1;
  padding: 16px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background-color: var(--bg);
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.03"><path fill="%236e8efb" d="M30,30 L70,30 L70,70 L30,70 Z"/></svg>');
  background-attachment: fixed;
}

.message {
  display: flex;
  max-width: 80%;
  margin: 2px 0;
  position: relative;
  transition: all 0.2s ease;
  animation: messageAppear 0.2s ease-out;
}

.message.incoming {
  align-self: flex-start;
  margin-right: auto;
}

.message.outgoing {
  align-self: flex-end;
  margin-left: auto;
}

.message-bubble {
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
  word-break: break-word;
  line-height: 1.4;
  font-size: 15px;
  box-shadow: 0 1px 2px var(--shadow);
  transition: all 0.2s ease;
}

.message.incoming .message-bubble {
  background: var(--incoming-bubble);
  border-bottom-left-radius: 4px;
  color: var(--text);
}

.message.outgoing .message-bubble {
  background: var(--outgoing-bubble);
  border-bottom-right-radius: 4px;
  color: var(--text);
  box-shadow: 0 1px 2px var(--shadow);
}

.message-bubble:hover {
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.message-meta {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  margin-top: 4px;
  gap: 4px;
}

.message-time {
  font-size: 12px;
  opacity: 0.7;
  color: var(--time-color);
}

.message-status {
  font-size: 12px;
  color: var(--time-color);
}

.message-image {
  max-width: 100%;
  max-height: 300px;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s;
}

.message-image:hover {
  transform: scale(1.02);
}

.message-sticker {
  max-width: 180px;
  max-height: 180px;
  border-radius: 12px;
}

.message-reply {
  padding: 8px 12px;
  background: rgba(0,0,0,0.03);
  border-left: 3px solid var(--primary);
  margin: -4px -12px 8px -12px;
  border-radius: 8px 8px 0 0;
}

.reply-header {
  font-size: 12px;
  font-weight: 500;
  margin-bottom: 2px;
  color: var(--primary);
}

.reply-text {
  font-size: 13px;
  opacity: 0.8;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Индикатор набора сообщения */
.typing-indicator {
  display: flex;
  gap: 4px;
  padding: 12px 16px;
  background: var(--card);
  border-radius: 18px;
  align-self: flex-start;
  margin-bottom: 8px;
  box-shadow: 0 1px 2px var(--shadow);
}

.typing-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: var(--text-secondary);
  animation: typing 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
  0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

@keyframes messageAppear {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Кастомный скроллбар */
.messages-container::-webkit-scrollbar {
  width: 6px;
}

.messages-container::-webkit-scrollbar-track {
  background: transparent;
}

.messages-container::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 3px;
}

.messages-container::-webkit-scrollbar-thumb:hover {
  background: rgba(0,0,0,0.3);
}

/* Адаптивность */
@media (max-width: 480px) {
  .messages-container {
    padding: 12px;
  }
  
  .message {
    max-width: 90%;
  }
}

/* Обновленные CSS переменные */
:root {
  --primary: #6e8efb;
  --primary-hover: #5a7df9;
  --bg: #f5f5f5;
  --card: #ffffff;
  --text: #333333;
  --text-secondary: #666666;
  --border: #e0e0e0;
  --incoming-bubble: #ffffff;
  --outgoing-bubble: #ffffff;
  --time-color: #707579;
  --shadow: rgba(0,0,0,0.08);
  --hover: rgba(0,0,0,0.05);
}

[data-theme="dark"] {
  --primary: #6e8efb;
  --primary-hover: #5a7df9;
  --bg: #1a1a1a;
  --card: #2d2d2d;
  --text: #ffffff;
  --text-secondary: #a0a0a0;
  --border: #404040;
  --incoming-bubble: #2d2d2d;
  --outgoing-bubble: #1e3a5f;
  --time-color: #a0a0a0;
  --shadow: rgba(0,0,0,0.2);
  --hover: rgba(255,255,255,0.05);
}

/* СТИЛИ ИЗ CENTER.HTML - ТОЧНАЯ КОПИЯ */
:root {
  --primary: #6e8efb;
  --primary-hover: #5a7df9;
  --bg: #f5f5f5;
  --card: #ffffff;
  --text: #333333;
  --text-secondary: #666666;
  --border: #e0e0e0;
  --incoming-bubble: #ffffff;
  --outgoing-bubble: #ffffff;
  --time-color: #707579;
  --shadow: rgba(0,0,0,0.08);
  --hover: rgba(0,0,0,0.05);
}

.messages-container {
  flex: 1;
  padding: 16px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background-color: var(--bg);
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.03"><path fill="%236e8efb" d="M30,30 L70,30 L70,70 L30,70 Z"/></svg>');
  background-attachment: fixed;
}

.message {
  display: flex;
  max-width: 80%;
  margin: 2px 0;
  position: relative;
  transition: all 0.2s ease;
}

.message.incoming {
  align-self: flex-start;
  margin-right: auto;
}

.message.outgoing {
  align-self: flex-end;
  margin-left: auto;
}

.message-bubble {
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
  word-break: break-word;
  line-height: 1.4;
  font-size: 15px;
  box-shadow: 0 1px 2px var(--shadow);
  transition: all 0.2s ease;
}

.message.incoming .message-bubble {
  background: var(--incoming-bubble);
  border-bottom-left-radius: 4px;
  color: var(--text);
}

.message.outgoing .message-bubble {
  background: var(--outgoing-bubble);
  border-bottom-right-radius: 4px;
  color: var(--text);
  box-shadow: 0 1px 2px var(--shadow);
}

.message-bubble:hover {
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.message-meta {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  margin-top: 4px;
  gap: 4px;
}

.message-time {
  font-size: 12px;
  opacity: 0.7;
  color: var(--time-color);
}

.message-status {
  font-size: 12px;
  color: var(--time-color);
}

.typing-indicator {
  display: flex;
  gap: 4px;
  padding: 12px 16px;
  background: var(--card);
  border-radius: 18px;
  align-self: flex-start;
  margin-bottom: 8px;
  box-shadow: 0 1px 2px var(--shadow);
}

.typing-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: var(--text-secondary);
  animation: typing 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
  0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

.message-image {
  max-width: 100%;
  max-height: 300px;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s;
}

.message-image:hover {
  transform: scale(1.02);
}

.message-sticker {
  max-width: 180px;
  max-height: 180px;
  border-radius: 12px;
}

.message-reply {
  padding: 8px 12px;
  background: rgba(0,0,0,0.03);
  border-left: 3px solid var(--primary);
  margin: -4px -12px 8px -12px;
  border-radius: 8px 8px 0 0;
}

.reply-header {
  font-size: 12px;
  font-weight: 500;
  margin-bottom: 2px;
  color: var(--primary);
}

.reply-text {
  font-size: 13px;
  opacity: 0.8;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

@keyframes messageAppear {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message {
  animation: messageAppear 0.2s ease-out;
}

.messages-container::-webkit-scrollbar {
  width: 6px;
}

.messages-container::-webkit-scrollbar-track {
  background: transparent;
}

.messages-container::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 3px;
}

.messages-container::-webkit-scrollbar-thumb:hover {
  background: rgba(0,0,0,0.3);
}

@media (max-width: 480px) {
  .messages-container {
    padding: 12px;
  }
  
  .message {
    max-width: 90%;
  }
}

/* УБИРАЕМ ВСЕ СТАРЫЕ СТИЛИ СООБЩЕНИЙ */
.message-bubble:before {
  display: none !important;
}

.message.incoming .message-bubble:before,
.message.outgoing .message-bubble:before {
  display: none !important;
}

/* Стили для создания группы */
.create-group-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: var(--card);
    border-radius: 12px;
    margin: 8px 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 2px dashed var(--border);
}

.create-group-btn:hover {
    background: var(--hover);
    border-color: var(--primary);
}

.create-group-btn i {
    color: var(--primary);
    font-size: 20px;
}

.create-group-btn span {
    font-weight: 500;
    color: var(--text);
}

/* Стили для модального окна создания группы */
.group-creation-steps {
    margin: 20px 0;
}

.step {
    display: none;
}

.step.active {
    display: block;
}

.step h4 {
    margin-bottom: 16px;
    color: var(--text);
}

.contacts-list {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px;
}

.contact-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.contact-item:hover {
    background: var(--hover);
}

.contact-select {
    width: 20px;
}

.contact-checkbox {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.contact-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 16px;
}

.contact-item img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

.contact-info {
    flex: 1;
}

.contact-name {
    font-weight: 500;
    color: var(--text);
}

.contact-username {
    font-size: 12px;
    color: var(--text-secondary);
}

.selected-members {
    margin-top: 16px;
    padding: 12px;
    background: var(--hover);
    border-radius: 8px;
    min-height: 60px;
}

.selected-title {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.selected-member {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: var(--card);
    padding: 6px 12px;
    border-radius: 20px;
    margin: 4px;
    font-size: 14px;
}

.remove-member {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 16px;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.remove-member:hover {
    background: var(--border);
    color: var(--text);
}

.loading, .no-contacts, .error {
    text-align: center;
    padding: 20px;
    color: var(--text-secondary);
}

/* Стили для групповых аватаров */
.group-avatar {
    background: linear-gradient(135deg, #ff6b6b, #ee5a24) !important;
    color: white !important;
}

.group-avatar i {
    font-size: 18px;
}

.chat-item .group-avatar {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Стили для кнопки создания группы в поиске */
.search-create-group-btn {
  padding: 16px;
  background: var(--card);
  border-radius: 12px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid var(--border);
}

.search-create-group-btn:hover {
  background: var(--hover);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.search-create-group-content {
  display: flex;
  align-items: center;
  gap: 12px;
}

.search-create-group-btn i {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 18px;
}

.search-create-group-text {
  flex: 1;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 2px;
}

.search-create-group-subtitle {
  font-size: 12px;
  color: var(--text-secondary);
}

/* Стили для кнопки назад в поиске */
.search-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
}

#search-back-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
}

#search-back-btn:hover {
  background: rgba(0,0,0,0.1);
  transform: scale(1.05);
}

.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
}

.search-input-wrapper i {
  position: absolute;
  left: 12px;
  color: var(--text-secondary);
  z-index: 1;
}

#search-input {
  width: 100%;
  padding: 12px 12px 12px 40px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: 14px;
  outline: none;
  transition: all 0.2s ease;
}

#search-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(110, 142, 251, 0.2);
}

.clear-search {
  position: absolute;
  right: 12px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.clear-search:hover {
  background: var(--hover);
  color: var(--text);
}

/* Для темной темы */
[data-theme="dark"] #search-back-btn {
  background: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] #search-back-btn:hover {
  background: rgba(255, 255, 255, 0.15);
}

.search-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--card);
  z-index: 1000;
  display: none;
  flex-direction: column;
  animation: searchSlideIn 0.3s ease-out;
}

@keyframes searchSlideIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

#search-back-btn {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  backdrop-filter: blur(10px);
}

#search-back-btn:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.05);
}

.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  background: var(--bg);
  border-radius: 24px;
  padding: 4px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.search-input-wrapper:focus-within {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 4px 16px rgba(110, 142, 251, 0.15);
}

.search-input-wrapper i {
  position: absolute;
  left: 16px;
  color: var(--text-secondary);
  z-index: 1;
  font-size: 16px;
}

#search-input {
  width: 100%;
  padding: 14px 14px 14px 48px;
  background: transparent;
  border: none;
  border-radius: 20px;
  font-size: 16px;
  outline: none;
  color: var(--text);
  font-weight: 500;
}

#search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
}

.clear-search {
  position: absolute;
  right: 12px;
  background: var(--hover);
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.2s ease;
  backdrop-filter: blur(10px);
}

.clear-search:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  background: var(--bg);
}

/* Стили для кнопки создания группы в поиске */
.search-create-group-btn {
  padding: 20px;
  background: var(--card);
  border-radius: 20px;
  margin-bottom: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.search-create-group-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s ease;
}

.search-create-group-btn:hover::before {
  left: 100%;
}

.search-create-group-btn:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 8px 32px rgba(110, 142, 251, 0.2);
}

.search-create-group-content {
  display: flex;
  align-items: center;
  gap: 16px;
}

.search-create-group-btn i {
  width: 52px;
  height: 52px;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  border-radius: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
}

.search-create-group-btn:hover i {
  transform: scale(1.1) rotate(5deg);
  box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.search-create-group-text {
  flex: 1;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 4px;
  font-size: 16px;
}

.search-create-group-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* Стили для результатов поиска */
.search-user-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 16px;
  background: var(--card);
  border-radius: 16px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid transparent;
  position: relative;
  overflow: hidden;
}

.search-user-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.search-user-item:hover::before {
  opacity: 1;
}

.search-user-item:hover {
  background: var(--card);
  border-color: var(--border);
  transform: translateX(4px);
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.search-user-avatar {
  width: 52px;
  height: 52px;
  border-radius: 16px;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.search-user-item:hover .search-user-avatar {
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.search-user-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 16px;
  object-fit: cover;
}

.search-user-info {
  flex: 1;
  min-width: 0;
}

.search-user-name {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 4px;
  font-size: 16px;
}

.search-user-username {
  font-size: 13px;
  color: var(--text-secondary);
}

.search-user-status {
  color: #25D366;
  font-size: 14px;
}

/* Состояния поиска */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-secondary);
}

.search-loading i {
  font-size: 32px;
  margin-bottom: 16px;
  color: var(--primary);
}

.search-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-empty-state i {
  font-size: 48px;
  margin-bottom: 16px;
  color: var(--border);
  opacity: 0.5;
}

.search-no-results {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-no-results i {
  font-size: 48px;
  margin-bottom: 16px;
  color: var(--border);
  opacity: 0.5;
}

/* Анимация для элементов поиска */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-user-item {
  animation: fadeInUp 0.4s ease-out;
}

.search-create-group-btn {
  animation: fadeInUp 0.3s ease-out;
}

/* Адаптивность */
@media (max-width: 480px) {
  .search-header {
    padding: 12px;
  }
  
  #search-input {
    padding: 12px 12px 12px 44px;
    font-size: 16px;
  }
  
  .search-results {
    padding: 12px;
  }
  
  .search-create-group-btn {
    padding: 16px;
    margin-bottom: 12px;
  }
  
  .search-user-item {
    padding: 14px;
    gap: 14px;
  }
  
  .search-user-avatar {
    width: 48px;
    height: 48px;
    border-radius: 14px;
  }
}

/* Для темной темы */
[data-theme="dark"] .search-input-wrapper {
  background: rgba(255,255,255,0.05);
}

[data-theme="dark"] .search-input-wrapper:focus-within {
  background: rgba(255,255,255,0.08);
}

[data-theme="dark"] .search-create-group-btn,
[data-theme="dark"] .search-user-item {
  background: rgba(255,255,255,0.05);
  border-color: rgba(255,255,255,0.1);
}

[data-theme="dark"] .search-create-group-btn:hover,
[data-theme="dark"] .search-user-item:hover {
  background: rgba(255,255,255,0.08);
  border-color: var(--primary);
}

/* Плавные переходы */
.search-container * {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Кастомный скроллбар для результатов поиска */
.search-results::-webkit-scrollbar {
  width: 6px;
}

.search-results::-webkit-scrollbar-track {
  background: transparent;
}

.search-results::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.search-results::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

.create-group-btn {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 20px;
    background: var(--card);
    border-radius: 20px;
    margin: 12px 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px dashed var(--border);
    position: relative;
    overflow: hidden;
}

.create-group-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(110, 142, 251, 0.1), transparent);
    transition: left 0.6s ease;
}

.create-group-btn:hover::before {
    left: 100%;
}

.create-group-btn:hover {
    background: var(--card);
    border-color: var(--primary);
    border-style: solid;
    transform: translateY(-2px);
    box-shadow: 0 8px 32px rgba(110, 142, 251, 0.15);
}

.create-group-btn i {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
}

.create-group-btn:hover i {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.create-group-btn span {
    font-weight: 600;
    color: var(--text);
    font-size: 16px;
    transition: color 0.3s ease;
}

.create-group-btn:hover span {
    color: var(--primary);
}

/* Анимация появления */
.create-group-btn {
    animation: slideInUp 0.5s ease-out;
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.search-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--card);
  z-index: 1000;
  display: none;
  flex-direction: column;
}

.search-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
}

/* Нормальная кнопка назад */
#search-back-btn {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
}

#search-back-btn:hover {
  background: var(--hover);
}

.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
}

.search-input-wrapper i {
  position: absolute;
  left: 12px;
  color: var(--text-secondary);
  z-index: 1;
}

#search-input {
  width: 100%;
  padding: 12px 12px 12px 40px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 16px;
  outline: none;
  color: var(--text);
}

#search-input:focus {
  border-color: var(--primary);
}

.clear-search {
  position: absolute;
  right: 12px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.clear-search:hover {
  background: var(--hover);
  color: var(--text);
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 8px 16px 16px;
  background: var(--bg);
}

/* Простая кнопка создания группы в поиске */
.search-create-group-btn {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: var(--card);
  border-radius: 12px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid var(--border);
}

.search-create-group-btn:hover {
  background: var(--hover);
  border-color: var(--primary);
}

.search-create-group-btn i {
  width: 40px;
  height: 40px;
  background: var(--primary);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 18px;
}

.search-create-group-text {
  flex: 1;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 2px;
  font-size: 15px;
}

.search-create-group-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
}

/* Стили для результатов поиска */
.search-user-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: var(--card);
  border-radius: 12px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid transparent;
}

.search-user-item:hover {
  background: var(--hover);
  border-color: var(--border);
}

.search-user-avatar {
  width: 44px;
  height: 44px;
  border-radius: 10px;
  background: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 16px;
  flex-shrink: 0;
}

.search-user-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 10px;
  object-fit: cover;
}

.search-user-info {
  flex: 1;
  min-width: 0;
}

.search-user-name {
  font-weight: 500;
  color: var(--text);
  margin-bottom: 2px;
  font-size: 15px;
}

.search-user-username {
  font-size: 13px;
  color: var(--text-secondary);
}

.search-user-status {
  color: #25D366;
  font-size: 14px;
}

/* Состояния поиска */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: var(--text-secondary);
}

.search-loading i {
  font-size: 24px;
  margin-bottom: 12px;
  color: var(--primary);
}

.search-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-empty-state i {
  font-size: 32px;
  margin-bottom: 12px;
  color: var(--border);
}

.search-no-results {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-no-results i {
  font-size: 32px;
  margin-bottom: 12px;
  color: var(--border);
}

/* Адаптивность */
@media (max-width: 480px) {
  .search-header {
    padding: 8px 12px;
  }
  
  #search-input {
    padding: 10px 10px 10px 36px;
    font-size: 16px;
  }
  
  .search-results {
    padding: 8px 12px 12px;
  }
  
  .search-create-group-btn {
    padding: 14px;
    margin-bottom: 8px;
  }
  
  .search-user-item {
    padding: 10px;
    gap: 10px;
  }
  
  .search-user-avatar {
    width: 40px;
    height: 40px;
  }
}

/* Кастомный скроллбар */
.search-results::-webkit-scrollbar {
  width: 4px;
}

.search-results::-webkit-scrollbar-track {
  background: transparent;
}

.search-results::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 2px;
}

.search-results::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

.create-group-btn {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 20px;
    background: var(--card);
    border-radius: 20px;
    margin: 12px 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px dashed var(--border);
    position: relative;
    overflow: hidden;
}

.create-group-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(110, 142, 251, 0.1), transparent);
    transition: left 0.6s ease;
}

.create-group-btn:hover::before {
    left: 100%;
}

.create-group-btn:hover {
    background: var(--card);
    border-color: var(--primary);
    border-style: solid;
    transform: translateY(-2px);
    box-shadow: 0 8px 32px rgba(110, 142, 251, 0.15);
}

.create-group-btn i {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
}

.create-group-btn:hover i {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.create-group-btn span {
    font-weight: 600;
    color: var(--text);
    font-size: 16px;
    transition: color 0.3s ease;
}

.create-group-btn:hover span {
    color: var(--primary);
}

/* Анимация появления */
.create-group-btn {
    animation: slideInUp 0.5s ease-out;
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.search-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--card);
  z-index: 1000;
  display: none;
  flex-direction: column;
}

/* Красивая верхняя шапка поиска */
.search-header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 16px;
  background: linear-gradient(135deg, var(--card) 0%, var(--bg) 100%);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

/* Красивая кнопка назад */
#search-back-btn {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  color: var(--text);
}

#search-back-btn:hover {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
}

/* Красивая строка поиска */
.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 4px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.search-input-wrapper:focus-within {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 4px 16px rgba(110, 142, 251, 0.15);
  transform: translateY(-1px);
}

.search-input-wrapper i {
  position: absolute;
  left: 16px;
  color: var(--text-secondary);
  z-index: 1;
  font-size: 16px;
  transition: all 0.3s ease;
}

.search-input-wrapper:focus-within i {
  color: var(--primary);
}

#search-input {
  width: 100%;
  padding: 14px 14px 14px 48px;
  background: transparent;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  outline: none;
  color: var(--text);
  font-weight: 500;
}

#search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
}

.clear-search {
  position: absolute;
  right: 12px;
  background: var(--hover);
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.clear-search:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  background: var(--bg);
}

/* Красивая кнопка создания группы в поиске */
.search-create-group-btn {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--card);
  border-radius: 20px;
  margin-bottom: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid var(--border);
  position: relative;
  overflow: hidden;
}

.search-create-group-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(110, 142, 251, 0.1), transparent);
  transition: left 0.6s ease;
}

.search-create-group-btn:hover::before {
  left: 100%;
}

.search-create-group-btn:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(110, 142, 251, 0.15);
}

.search-create-group-btn i {
  width: 52px;
  height: 52px;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(110, 142, 251, 0.3);
}

.search-create-group-btn:hover i {
  transform: scale(1.05);
  box-shadow: 0 6px 18px rgba(110, 142, 251, 0.4);
}

.search-create-group-text {
  flex: 1;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 4px;
  font-size: 16px;
}

.search-create-group-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* Стили для результатов поиска */
.search-user-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 16px;
  background: var(--card);
  border-radius: 16px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--border);
}

.search-user-item:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
}

.search-user-avatar {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 16px;
  flex-shrink: 0;
  transition: all 0.3s ease;
}

.search-user-item:hover .search-user-avatar {
  transform: scale(1.05);
}

.search-user-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 12px;
  object-fit: cover;
}

.search-user-info {
  flex: 1;
  min-width: 0;
}

.search-user-name {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 4px;
  font-size: 15px;
}

.search-user-username {
  font-size: 13px;
  color: var(--text-secondary);
}

.search-user-status {
  color: #25D366;
  font-size: 14px;
}

/* Состояния поиска */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-secondary);
}

.search-loading i {
  font-size: 32px;
  margin-bottom: 16px;
  color: var(--primary);
}

.search-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-empty-state i {
  font-size: 48px;
  margin-bottom: 16px;
  color: var(--border);
  opacity: 0.5;
}

.search-no-results {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.search-no-results i {
  font-size: 48px;
  margin-bottom: 16px;
  color: var(--border);
  opacity: 0.5;
}

/* Анимация для элементов поиска */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-user-item {
  animation: fadeInUp 0.3s ease-out;
}

.search-create-group-btn {
  animation: fadeInUp 0.3s ease-out;
}

/* Адаптивность */
@media (max-width: 480px) {
  .search-header {
    padding: 12px;
  }
  
  #search-input {
    padding: 12px 12px 12px 44px;
    font-size: 16px;
  }
  
  .search-results {
    padding: 12px;
  }
  
  .search-create-group-btn {
    padding: 16px;
    margin-bottom: 12px;
  }
  
  .search-user-item {
    padding: 14px;
    gap: 14px;
  }
  
  .search-user-avatar {
    width: 44px;
    height: 44px;
  }
}

/* Для темной темы */
[data-theme="dark"] .search-input-wrapper {
  background: rgba(255,255,255,0.05);
  border-color: rgba(255,255,255,0.1);
}

[data-theme="dark"] .search-input-wrapper:focus-within {
  background: rgba(255,255,255,0.08);
}

[data-theme="dark"] .search-create-group-btn,
[data-theme="dark"] .search-user-item {
  background: rgba(255,255,255,0.05);
  border-color: rgba(255,255,255,0.1);
}

[data-theme="dark"] .search-create-group-btn:hover,
[data-theme="dark"] .search-user-item:hover {
  background: rgba(255,255,255,0.08);
  border-color: var(--primary);
}

/* Кастомный скроллбар */
.search-results::-webkit-scrollbar {
  width: 6px;
}

.search-results::-webkit-scrollbar-track {
  background: transparent;
}

.search-results::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.search-results::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

/* Обновленные стили для поиска */
.search-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  min-height: 64px; /* Фиксированная высота для выравнивания */
}

/* Кнопка назад - выравниваем по центру */
#search-back-btn {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  flex-shrink: 0; /* Запрещаем сжатие */
}

#search-back-btn:hover {
  background: var(--hover);
}

/* Поисковая строка - занимает оставшееся пространство */
.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  margin-left: 0; /* Убираем лишние отступы */
}

.search-input-wrapper i {
  position: absolute;
  left: 12px;
  color: var(--text-secondary);
  z-index: 1;
}

#search-input {
  width: 100%;
  padding: 12px 12px 12px 40px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 16px;
  outline: none;
  color: var(--text);
}

#search-input:focus {
  border-color: var(--primary);
}

.clear-search {
  position: absolute;
  right: 12px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.clear-search:hover {
  background: var(--hover);
  color: var(--text);
}

/* Для мобильных устройств - более компактно */
@media (max-width: 480px) {
  .search-header {
    padding: 8px 12px;
    min-height: 56px; /* Меньшая высота на мобильных */
    gap: 8px; /* Меньше расстояние между элементами */
  }
  
  #search-back-btn {
    width: 36px;
    height: 36px;
  }
  
  #search-input {
    padding: 10px 10px 10px 36px;
    font-size: 16px;
  }
  
  .search-input-wrapper i {
    left: 10px;
  }
  
  .clear-search {
    right: 10px;
  }
}

/* Альтернативный вариант - если нужно еще более компактно */
.search-header.compact {
  padding: 8px 12px;
  min-height: 56px;
  gap: 8px;
}

.search-header.compact #search-back-btn {
  width: 36px;
  height: 36px;
}

.search-header.compact #search-input {
  padding: 10px 10px 10px 36px;
}

/* РАЗБЛОКИРОВКА ВСЕХ КНОПОК НАЗАД, КРОМЕ ЭКРАНА ПАРОЛЯ */
.back-btn:not(#password-screen .back-btn),
#back-btn:not(#password-screen .back-btn),
#search-back-btn,
#settings-back-btn,
#notifications-back-btn,
#privacy-back-btn,
#appearance-back-btn,
#help-back-btn,
.friend-search-back {
    position: relative !important;
    top: auto !important;
    left: auto !important;
    right: auto !important;
    bottom: auto !important;
    width: auto !important;
    height: auto !important;
    min-width: auto !important;
    min-height: auto !important;
    margin: 8px !important;
    flex-shrink: 0 !important;
}

/* Исключаем кнопку назад в экране пароля из разблокировки */
#password-screen .back-btn,
#back-to-username {
    /* Оставляем как есть - заблокированными */
}

/* Разблокировка контейнеров, кроме экрана пароля */
.chat-header-content,
.search-header,
.settings-header,
.auth-header:not(#password-screen .auth-header) {
    display: flex !important;
    align-items: center !important;
    flex-wrap: nowrap !important;
}

/* Разблокировка кнопки назад в чате */
.chat-header-content #back-btn {
    order: -1 !important;
    margin-right: 12px !important;
}

/* Разблокировка кнопки назад в поиске */
.search-header #search-back-btn {
    order: -1 !important;
    margin-right: 12px !important;
}

/* Разблокировка кнопки назад в настройках */
.settings-header .settings-back-btn {
    order: -1 !important;
    margin-right: 12px !important;
}

/* Разблокировка форм, кроме экрана пароля */
.auth-form:not(#password-screen .auth-form) {
    display: flex !important;
    flex-direction: column !important;
    gap: 16px !important;
}

/* Убираем фиксированные высоты, кроме экрана пароля */
.auth-container:not(#password-screen .auth-container),
.login-container:not(#password-screen .login-container) {
    min-height: auto !important;
    height: auto !important;
    justify-content: flex-start !important;
    padding: 40px 20px !important;
}

/* Делаем кнопки гибкими, кроме экрана пароля */
.back-btn:not(#password-screen .back-btn),
#back-btn:not(#password-screen .back-btn),
#search-back-btn {
    padding: 12px 16px !important;
    border-radius: 8px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
}

/* Ховер-эффекты для всех кнопок назад, кроме экрана пароля */
.back-btn:not(#password-screen .back-btn):hover,
#back-btn:not(#password-screen .back-btn):hover,
#search-back-btn:hover {
    background: var(--hover) !important;
    transform: translateY(-1px) !important;
}

/* ===== ПЕРЕРАБОТАННЫЙ ДИЗАЙН ПОИСКА ===== */

.search-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  height: 80vh;
  max-height: 700px;
  background: var(--card);
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  display: none;
  flex-direction: column;
  overflow: hidden;
  border: 1px solid var(--border);
  animation: searchModalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes searchModalAppear {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

.search-header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 24px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  position: relative;
}

.search-back-btn {
  width: 44px;
  height: 44px;
  border-radius: 14px;
  background: var(--bg);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  color: var(--text);
  flex-shrink: 0;
}

.search-back-btn:hover {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 4px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.search-input-wrapper:focus-within {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 4px 20px rgba(110, 142, 251, 0.2);
  transform: translateY(-1px);
}

.search-input-wrapper i {
  position: absolute;
  left: 16px;
  color: var(--text-secondary);
  z-index: 1;
  font-size: 18px;
  transition: all 0.3s ease;
}

.search-input-wrapper:focus-within i {
  color: var(--primary);
}

.search-input {
  width: 100%;
  padding: 14px 14px 14px 48px;
  background: transparent;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  outline: none;
  color: var(--text);
  font-weight: 500;
  font-family: inherit;
}

.search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
}

.clear-search {
  position: absolute;
  right: 12px;
  background: var(--hover);
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: all 0.3s ease;
  font-size: 14px;
}

.clear-search:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 0 20px 20px;
  background: var(--bg);
  display: flex;
  flex-direction: column;
}

/* Кнопка создания группы */
.search-create-group-btn {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--card);
  border-radius: 18px;
  margin: 20px 0 16px;
  cursor: pointer;
  transition: all 0.4s ease;
  border: 2px solid var(--border);
  position: relative;
  overflow: hidden;
}

.search-create-group-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(110, 142, 251, 0.1), transparent);
  transition: left 0.6s ease;
}

.search-create-group-btn:hover::before {
  left: 100%;
}

.search-create-group-btn:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-3px);
  box-shadow: 0 8px 30px rgba(110, 142, 251, 0.2);
}

.search-create-group-btn i {
  width: 52px;
  height: 52px;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
  transition: all 0.4s ease;
  box-shadow: 0 4px 15px rgba(110, 142, 251, 0.3);
  flex-shrink: 0;
}

.search-create-group-btn:hover i {
  transform: scale(1.1) rotate(5deg);
  box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.search-create-group-text {
  flex: 1;
  min-width: 0;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
  font-size: 16px;
  line-height: 1.2;
}

.search-create-group-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* Результаты поиска */
.search-user-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 18px;
  background: var(--card);
  border-radius: 16px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
}

.search-user-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.search-user-item:hover::before {
  opacity: 1;
}

.search-user-item:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.search-user-avatar {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  position: relative;
  overflow: hidden;
}

.search-user-item:hover .search-user-avatar {
  transform: scale(1.08);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
}

.search-user-avatar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
  transition: transform 0.6s ease;
}

.search-user-item:hover .search-user-avatar::before {
  transform: translateX(100%);
}

.search-user-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 14px;
  object-fit: cover;
  position: relative;
  z-index: 1;
}

.search-user-info {
  flex: 1;
  min-width: 0;
}

.search-user-name {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
  font-size: 16px;
  line-height: 1.2;
}

.search-user-username {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.3;
}

.search-user-status {
  color: #25D366;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
}

/* Состояния поиска */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-secondary);
  flex: 1;
}

.search-loading i {
  font-size: 32px;
  margin-bottom: 20px;
  color: var(--primary);
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.1); }
}

.search-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
  flex: 1;
}

.search-empty-state i {
  font-size: 64px;
  margin-bottom: 20px;
  color: var(--border);
  opacity: 0.5;
}

.search-no-results {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
  flex: 1;
}

.search-no-results i {
  font-size: 64px;
  margin-bottom: 20px;
  color: var(--border);
  opacity: 0.5;
}

/* Анимации */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(15px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-user-item {
  animation: fadeInUp 0.4s ease-out;
}

.search-create-group-btn {
  animation: fadeInUp 0.3s ease-out;
}

/* Адаптивность */
@media (max-width: 768px) {
  .search-container {
    width: 95%;
    height: 85vh;
    border-radius: 20px;
  }
  
  .search-header {
    padding: 20px;
  }
  
  .search-input {
    padding: 12px 12px 12px 44px;
  }
  
  .search-results {
    padding: 0 16px 16px;
  }
  
  .search-create-group-btn {
    padding: 18px;
    margin: 16px 0 12px;
  }
  
  .search-user-item {
    padding: 16px;
    gap: 14px;
  }
  
  .search-user-avatar {
    width: 48px;
    height: 48px;
  }
}

@media (max-width: 480px) {
  .search-container {
    width: 100%;
    height: 100vh;
    border-radius: 0;
    max-width: none;
    max-height: none;
  }
  
  .search-header {
    padding: 16px;
  }
  
  .search-back-btn {
    width: 40px;
    height: 40px;
  }
  
  .search-input {
    padding: 10px 10px 10px 40px;
    font-size: 16px;
  }
  
  .search-results {
    padding: 0 12px 12px;
  }
}

/* Кастомный скроллбар */
.search-results::-webkit-scrollbar {
  width: 6px;
}

.search-results::-webkit-scrollbar-track {
  background: transparent;
  margin: 8px 0;
}

.search-results::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.3s ease;
}

.search-results::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

/* Для темной темы */
[data-theme="dark"] .search-container {
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

[data-theme="dark"] .search-input-wrapper {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .search-input-wrapper:focus-within {
  background: rgba(255, 255, 255, 0.08);
}

[data-theme="dark"] .search-create-group-btn,
[data-theme="dark"] .search-user-item {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .search-create-group-btn:hover,
[data-theme="dark"] .search-user-item:hover {
  background: rgba(255, 255, 255, 0.08);
}

/* Оверлей для фона */
.search-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  z-index: 999;
  display: none;
  animation: overlayFadeIn 0.3s ease-out;
}

@keyframes overlayFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Анимация закрытия */
.search-container.closing {
  animation: searchModalDisappear 0.3s ease-in forwards;
}

@keyframes searchModalDisappear {
  from {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
}

/* ===== ИСПРАВЛЕННЫЙ ДИЗАЙН ПОИСКА ===== */

.search-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  height: 80vh;
  max-height: 700px;
  background: var(--card);
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  display: none;
  flex-direction: column;
  overflow: hidden;
  border: 1px solid var(--border);
  animation: searchModalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes searchModalAppear {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

.search-header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 24px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  position: relative;
  flex-shrink: 0; /* Фиксируем header */
  min-height: 88px; /* Минимальная высота */
  box-sizing: border-box;
}

.search-back-btn {
  width: 44px;
  height: 44px;
  border-radius: 14px;
  background: var(--bg);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  color: var(--text);
  flex-shrink: 0;
}

.search-back-btn:hover {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 4px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  min-height: 52px; /* Фиксируем высоту поля ввода */
  box-sizing: border-box;
}

.search-input-wrapper:focus-within {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 4px 20px rgba(110, 142, 251, 0.2);
  transform: translateY(-1px);
}

.search-input-wrapper i {
  position: absolute;
  left: 16px;
  color: var(--text-secondary);
  z-index: 1;
  font-size: 18px;
  transition: all 0.3s ease;
}

.search-input-wrapper:focus-within i {
  color: var(--primary);
}

.search-input {
  width: 100%;
  padding: 14px 14px 14px 48px;
  background: transparent;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  outline: none;
  color: var(--text);
  font-weight: 500;
  font-family: inherit;
  min-height: 44px; /* Фиксируем высоту инпута */
  box-sizing: border-box;
}

.search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
}

.clear-search {
  position: absolute;
  right: 12px;
  background: var(--hover);
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: all 0.3s ease;
  font-size: 14px;
  flex-shrink: 0;
}

.clear-search:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 0 20px 20px;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  min-height: 0; /* Важно для правильного скролла */
}

/* Кнопка создания группы */
.search-create-group-btn {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--card);
  border-radius: 18px;
  margin: 20px 0 16px;
  cursor: pointer;
  transition: all 0.4s ease;
  border: 2px solid var(--border);
  position: relative;
  overflow: hidden;
  flex-shrink: 0; /* Фиксируем размер */
  min-height: 92px; /* Минимальная высота */
  box-sizing: border-box;
}

.search-create-group-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(110, 142, 251, 0.1), transparent);
  transition: left 0.6s ease;
}

.search-create-group-btn:hover::before {
  left: 100%;
}

.search-create-group-btn:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-3px);
  box-shadow: 0 8px 30px rgba(110, 142, 251, 0.2);
}

.search-create-group-btn i {
  width: 52px;
  height: 52px;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
  transition: all 0.4s ease;
  box-shadow: 0 4px 15px rgba(110, 142, 251, 0.3);
  flex-shrink: 0;
}

.search-create-group-btn:hover i {
  transform: scale(1.1) rotate(5deg);
  box-shadow: 0 6px 20px rgba(110, 142, 251, 0.4);
}

.search-create-group-text {
  flex: 1;
  min-width: 0;
}

.search-create-group-title {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
  font-size: 16px;
  line-height: 1.2;
}

.search-create-group-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* Результаты поиска */
.search-user-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 18px;
  background: var(--card);
  border-radius: 16px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
  flex-shrink: 0; /* Фиксируем размер элементов */
  min-height: 88px; /* Минимальная высота карточки */
  box-sizing: border-box;
}

.search-user-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.search-user-item:hover::before {
  opacity: 1;
}

.search-user-item:hover {
  background: var(--card);
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.search-user-avatar {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
  flex-shrink: 0;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  position: relative;
  overflow: hidden;
}

.search-user-item:hover .search-user-avatar {
  transform: scale(1.08);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
}

.search-user-avatar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
  transition: transform 0.6s ease;
}

.search-user-item:hover .search-user-avatar::before {
  transform: translateX(100%);
}

.search-user-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 14px;
  object-fit: cover;
  position: relative;
  z-index: 1;
}

.search-user-info {
  flex: 1;
  min-width: 0;
}

.search-user-name {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
  font-size: 16px;
  line-height: 1.2;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.search-user-username {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.3;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.search-user-status {
  color: #25D366;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  flex-shrink: 0;
}

/* Состояния поиска */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: var(--text-secondary);
  flex: 1;
  min-height: 200px; /* Минимальная высота для состояния загрузки */
}

.search-loading i {
  font-size: 32px;
  margin-bottom: 20px;
  color: var(--primary);
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.1); }
}

.search-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: var(--text-secondary);
  flex: 1;
  min-height: 200px; /* Минимальная высота для пустого состояния */
}

.search-empty-state i {
  font-size: 48px;
  margin-bottom: 20px;
  color: var(--border);
  opacity: 0.5;
}

.search-no-results {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: var(--text-secondary);
  flex: 1;
  min-height: 200px; /* Минимальная высота для отсутствия результатов */
}

.search-no-results i {
  font-size: 48px;
  margin-bottom: 20px;
  color: var(--border);
  opacity: 0.5;
}

/* Анимации */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(15px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-user-item {
  animation: fadeInUp 0.4s ease-out;
}

.search-create-group-btn {
  animation: fadeInUp 0.3s ease-out;
}

/* Адаптивность для мобильных с клавиатурой */
@media (max-width: 768px) {
  .search-container {
    width: 95%;
    height: 85vh;
    border-radius: 20px;
    /* Для мобильных с клавиатурой делаем более адаптивным */
    max-height: 90vh;
  }
  
  .search-header {
    padding: 16px;
    min-height: 80px;
  }
  
  .search-input-wrapper {
    min-height: 48px;
  }
  
  .search-input {
    padding: 12px 12px 12px 44px;
    min-height: 40px;
    font-size: 16px; /* Увеличиваем для удобства на мобильных */
  }
  
  .search-results {
    padding: 0 16px 16px;
  }
  
  .search-create-group-btn {
    padding: 16px;
    margin: 16px 0 12px;
    min-height: 84px;
  }
  
  .search-user-item {
    padding: 16px;
    gap: 14px;
    min-height: 80px;
    margin-bottom: 10px;
  }
  
  .search-user-avatar {
    width: 48px;
    height: 48px;
  }
  
  /* Специальные стили когда клавиатура открыта */
  @media (max-height: 600px) {
    .search-container {
      height: 95vh;
      max-height: 95vh;
      top: 2.5vh;
      transform: translate(-50%, 0);
    }
    
    .search-header {
      padding: 12px 16px;
      min-height: 72px;
    }
    
    .search-results {
      padding: 0 12px 12px;
    }
    
    .search-create-group-btn {
      margin: 12px 0 8px;
      min-height: 76px;
      padding: 14px;
    }
    
    .search-user-item {
      padding: 14px;
      min-height: 72px;
      margin-bottom: 8px;
    }
  }
}

@media (max-width: 480px) {
  .search-container {
    width: 100%;
    height: 100vh;
    border-radius: 0;
    max-width: none;
    max-height: none;
    top: 0;
    transform: translateX(-50%);
  }
  
  .search-header {
    padding: 12px 16px;
    min-height: 72px;
  }
  
  .search-back-btn {
    width: 40px;
    height: 40px;
  }
  
  .search-input {
    padding: 10px 10px 10px 40px;
    font-size: 16px;
    min-height: 38px;
  }
  
  .search-results {
    padding: 0 12px 12px;
  }
  
  /* Для очень маленьких экранов с клавиатурой */
  @media (max-height: 500px) {
    .search-header {
      padding: 8px 12px;
      min-height: 64px;
    }
    
    .search-input-wrapper {
      min-height: 44px;
    }
    
    .search-create-group-btn {
      display: none; /* Скрываем кнопку создания группы когда мало места */
    }
  }
}

/* Кастомный скроллбар */
.search-results::-webkit-scrollbar {
  width: 6px;
}

.search-results::-webkit-scrollbar-track {
  background: transparent;
  margin: 8px 0;
}

.search-results::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.3s ease;
}

.search-results::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

/* Для темной темы */
[data-theme="dark"] .search-container {
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

[data-theme="dark"] .search-input-wrapper {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .search-input-wrapper:focus-within {
  background: rgba(255, 255, 255, 0.08);
}

[data-theme="dark"] .search-create-group-btn,
[data-theme="dark"] .search-user-item {
  background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .search-create-group-btn:hover,
[data-theme="dark"] .search-user-item:hover {
  background: rgba(255, 255, 255, 0.08);
}

/* Оверлей для фона */
.search-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  z-index: 999;
  display: none;
  animation: overlayFadeIn 0.3s ease-out;
}

@keyframes overlayFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Анимация закрытия */
.search-container.closing {
  animation: searchModalDisappear 0.3s ease-in forwards;
}

@keyframes searchModalDisappear {
  from {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
}

/* Гарантируем что элементы не накладываются */
.search-results > * {
  margin-bottom: 12px;
}

.search-results > *:last-child {
  margin-bottom: 0;
}

/* Фиксируем контейнер от наложения */
.search-results-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1;
  overflow-y: auto;
}

/* ===== ОТКЛЮЧЕНИЕ АВТОФОКУСА ===== */

.search-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  height: 80vh;
  max-height: 700px;
  background: var(--card);
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  display: none;
  flex-direction: column;
  overflow: hidden;
  border: 1px solid var(--border);
  animation: searchModalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Отключаем автофокус визуально */
.search-input {
  width: 100%;
  padding: 14px 14px 14px 48px;
  background: transparent;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  outline: none;
  color: var(--text);
  font-weight: 500;
  font-family: inherit;
  min-height: 44px;
  box-sizing: border-box;
  /* Отключаем стандартное поведение */
  caret-color: transparent; /* Скрываем курсор */
}

/* Показываем курсор только при ручном фокусе */
.search-input:focus {
  caret-color: var(--primary); /* Показываем курсор только при ручном фокусе */
}

/* Стиль для неактивного состояния */
.search-input:not(:focus) {
  background: var(--bg);
}

/* Индикатор что поле можно активировать */
.search-input-wrapper {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 4px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  min-height: 52px;
  box-sizing: border-box;
  cursor: text; /* Показываем что можно кликнуть */
}

.search-input-wrapper:focus-within {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 4px 20px rgba(110, 142, 251, 0.2);
  transform: translateY(-1px);
}

/* Подсказка для пользователя */
.search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
  transition: opacity 0.3s ease;
}

.search-input:focus::placeholder {
  opacity: 0.7;
}

/* Анимация появления без автофокуса */
@keyframes searchModalAppear {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

/* Кнопка для ручного включения клавиатуры */
.search-keyboard-toggle {
  position: absolute;
  right: 50px;
  background: var(--hover);
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: all 0.3s ease;
  font-size: 16px;
  opacity: 0.7;
}

.search-keyboard-toggle:hover {
  background: var(--primary);
  color: white;
  opacity: 1;
  transform: scale(1.1);
}

/* Показываем кнопку только на мобильных */
@media (max-width: 768px) {
  .search-keyboard-toggle {
    display: flex;
  }
}

@media (min-width: 769px) {
  .search-keyboard-toggle {
    display: none;
  }
}

.chat-header {
  background-color: var(--card);
  padding: 8px 16px; /* Уменьшили padding сверху/снизу */
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  z-index: 10;
  position: sticky;
  top: 0;
  min-height: 50px; /* Добавили минимальную высоту */
}

.chat-header-content {
  display: flex;
  align-items: center;
  gap: 10px; /* Уменьшили gap */
  flex: 1;
}

#back-btn {
  width: 36px; /* Уменьшили размер */
  height: 36px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  margin: 0;
  padding: 0;
  min-width: auto;
}

#chat-header-avatar {
  width: 36px; /* Уменьшили размер */
  height: 36px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 16px; /* Уменьшили шрифт */
  flex-shrink: 0;
}

.chat-header-info {
  flex: 1;
  min-width: 0;
}

.chat-title {
  font-size: 14px; /* Уменьшили шрифт */
  font-weight: 600;
  color: var(--text);
  margin-bottom: 1px; /* Уменьшили отступ */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-status {
  font-size: 12px; /* Уменьшили шрифт */
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.2;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 6px; /* Уменьшили gap */
}

.chat-action-btn {
  width: 36px; /* Уменьшили размер */
  height: 36px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-secondary);
}

.chat-header {
  background-color: var(--card);
  padding: 6px 14px; /* Уменьшили еще больше */
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
  z-index: 10;
  position: sticky;
  top: 0;
  min-height: 44px; /* Значительно уменьшили минимальную высоту */
}

.chat-header-content {
  display: flex;
  align-items: center;
  gap: 8px; /* Уменьшили gap еще больше */
  flex: 1;
}

#back-btn {
  width: 32px; /* Уменьшили размер еще больше */
  height: 32px;
  border-radius: 50%;
  background: var(--hover);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text);
  margin: 0;
  padding: 0;
  min-width: auto;
}

#back-btn i {
  font-size: 16px; /* Уменьшили иконку */
}

#chat-header-avatar {
  width: 32px; /* Уменьшили размер еще больше */
  height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 14px; /* Уменьшили шрифт еще больше */
  flex-shrink: 0;
}

.chat-header-info {
  flex: 1;
  min-width: 0;
}

.chat-title {
  font-size: 13px; /* Уменьшили шрифт еще больше */
  font-weight: 600;
  color: var(--text);
  margin-bottom: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-status {
  font-size: 11px; /* Уменьшили шрифт еще больше */
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.1;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 4px; /* Уменьшили gap еще больше */
}

.chat-action-btn {
  width: 32px; /* Уменьшили размер еще больше */
  height: 32px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-secondary);
}

.chat-action-btn i {
  font-size: 16px; /* Уменьшили иконки */
}

/* Уменьшаем verified badge в шапке чата */
.chat-name-wrapper .verified-badge lottie-player {
  width: 16px !important; /* Уменьшили размер бейджа */
  height: 16px !important;
}

/* Стили для групповых сообщений */
.message.incoming[data-is-group="true"] {
    margin-bottom: 8px;
}

.message.incoming[data-is-group="true"] .message-sender {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 4px;
    display: block;
    padding-left: 8px;
}

.message.incoming[data-is-group="true"] .message-bubble {
    margin-top: 2px;
}

/* Для исходящих сообщений в группе - без подписи */
.message.outgoing[data-is-group="true"] .message-sender {
    display: none;
}

/* Адаптация для тем */
[data-theme="dark"] .message.incoming[data-is-group="true"] .message-sender {
    color: #94a3b8;
}

[data-theme="light"] .message.incoming[data-is-group="true"] .message-sender {
    color: #64748b;
}

.message.encryption-failed .message-bubble {
    border: 1px solid #ff6b6b;
    background: rgba(255, 107, 107, 0.1);
}

.message.unencrypted .message-bubble {
    border: 1px solid #ffa502;
    background: rgba(255, 165, 2, 0.1);
}

.message.encryption-failed .message-text::before {
    content: '⚠️ ';
    font-size: 12px;
}

/* Стили для экрана информации о группе */
.group-info-content {
  flex: 1;
  overflow-y: auto;
  padding: 0;
}

.group-header-section {
  padding: 30px 20px;
  text-align: center;
  background: linear-gradient(135deg, var(--primary), #a777e3);
  color: white;
}

.group-avatar-large {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 16px;
  font-size: 32px;
}

.group-name {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 8px;
}

.group-members-count {
  opacity: 0.9;
  font-size: 14px;
}

.group-details-section {
  padding: 20px;
}

.members-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.member-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  background: var(--card);
  border-radius: 12px;
  border: 1px solid var(--border);
}

.member-info {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.member-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 16px;
}

.member-item img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.member-details {
  flex: 1;
}

.member-name {
  font-weight: 500;
  color: var(--text);
  margin-bottom: 2px;
}

.member-username {
  font-size: 12px;
  color: var(--text-secondary);
}

.member-status {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-secondary);
}

.online-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #25D366;
}

.you-badge {
  background: var(--primary);
  color: white;
  padding: 2px 6px;
  border-radius: 8px;
  font-size: 10px;
  font-weight: 500;
}

.error-message {
  text-align: center;
  padding: 20px;
  color: var(--text-secondary);
}

/* Анимация появления */
#group-info-screen {
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Стили для экрана информации о группе из uu.html */
.group-info-container {
  max-width: 500px;
  margin: 0 auto;
  background-color: var(--card);
  min-height: 100vh;
  color: var(--text);
}

.group-header {
  display: flex;
  align-items: center;
  padding: 11px 16px;
  border-bottom: 1px solid var(--border);
  background-color: var(--card);
  position: sticky;
  top: 0;
  z-index: 10;
  min-height: 50px;
}

.back-button {
  background: none;
  border: none;
  font-size: 18px;
  color: var(--primary);
  cursor: pointer;
  margin-right: 16px;
  width: 35px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background-color 0.2s;
}

.back-button:hover {
  background-color: var(--hover);
}

.header-title {
  font-size: 17px;
  font-weight: 600;
}

.group-info-section {
  padding: 24px 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  border-bottom: 1px solid var(--border);
}

.group-avatar {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 36px;
  font-weight: 600;
  margin-bottom: 16px;
  position: relative;
  overflow: hidden;
}

.group-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.group-name {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 8px;
}

.group-members-count {
  font-size: 14px;
  color: var(--text-secondary);
}

.quick-actions {
  display: flex;
  padding: 16px;
  border-bottom: 1px solid var(--border);
  gap: 12px;
}

.action-button {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px;
  background-color: var(--bg);
  border-radius: 12px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.action-button:hover {
  background-color: var(--hover);
}

.action-icon {
  font-size: 20px;
  color: var(--primary);
  margin-bottom: 8px;
}

.action-text {
  font-size: 13px;
  font-weight: 500;
}

.members-section {
  padding: 16px;
}

.section-title {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 12px;
  padding-left: 8px;
}

.members-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.member-item {
  display: flex;
  align-items: center;
  padding: 12px;
  background-color: var(--bg);
  border-radius: 12px;
  transition: background-color 0.2s;
  cursor: pointer;
}

.member-item:hover {
  background-color: var(--hover);
}

.member-avatar {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6e8efb, #a777e3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  margin-right: 12px;
  flex-shrink: 0;
}

.member-avatar img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

.member-info {
  flex: 1;
}

.member-name {
  font-weight: 500;
  margin-bottom: 4px;
}

.member-username {
  font-size: 13px;
  color: var(--text-secondary);
}

.member-role {
  font-size: 12px;
  color: var(--primary);
  font-weight: 500;
  padding: 4px 8px;
  background-color: var(--hover);
  border-radius: 6px;
}

.settings-section {
  padding: 16px;
}

.settings-item {
  display: flex;
  align-items: center;
  padding: 16px 12px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  transition: background-color 0.2s;
}

.settings-item:last-child {
  border-bottom: none;
}

.settings-item:hover {
  background-color: var(--hover);
}

.settings-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background-color: var(--hover);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--primary);
  margin-right: 12px;
  flex-shrink: 0;
}

.settings-text {
  flex: 1;
}

.settings-title {
  font-weight: 500;
  margin-bottom: 4px;
}

.settings-desc {
  font-size: 13px;
  color: var(--text-secondary);
}

.settings-arrow {
  color: var(--text-secondary);
}

.danger-section {
  padding: 16px;
  margin-top: 16px;
  border-top: 1px solid var(--border);
}

.danger-section .settings-icon {
  background-color: rgba(255, 59, 48, 0.1);
  color: #ff3b30;
}

.danger-section .settings-title {
  color: #ff3b30;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.group-info-container > * {
  animation: fadeIn 0.3s ease-out;
}

.no-members, .error-message {
  text-align: center;
  padding: 20px;
  color: var(--text-secondary);
  font-style: italic;
}

.chat-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background-color 0.2s;
}

.chat-item:hover {
    background-color: rgba(0, 0, 0, 0.03);
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    font-size: 18px;
    margin-right: 12px;
    flex-shrink: 0;
}

.chat-avatar.group-avatar {
    background: #666;
}

.chat-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

.avatar-text {
    font-weight: bold;
    font-size: 18px;
}

.chat-info {
    flex: 1;
    min-width: 0;
}

.chat-name {
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.chat-last-msg {
    font-size: 14px;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.verified-badge {
    display: inline-flex;
    align-items: center;
}

.chat-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background-color 0.2s;
    min-height: 70px;
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.chat-avatar.group-avatar {
    background: #666;
}

.chat-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

.avatar-text {
    font-weight: bold;
    font-size: 20px;
}

.chat-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.chat-name-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
    min-height: 24px;
}

.chat-name-text {
    font-weight: 600;
    font-size: 16px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

.chat-last-msg {
    font-size: 14px;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.verified-badge {
    display: inline-flex;
    align-items: center;
    flex-shrink: 0;
}

.chat-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background-color 0.2s;
    height: 72px; /* Фиксированная высота для всех чатов */
    box-sizing: border-box;
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    margin-right: 12px;
    flex-shrink: 0;
    overflow: hidden;
}

.chat-avatar.group-avatar {
    background: #666;
}

.chat-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-text {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    font-weight: bold;
    font-size: 18px;
}

.chat-avatar.group-avatar .avatar-text {
    font-size: 20px; /* Немного больше для иконки группы */
}

.chat-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
}

.chat-name-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
    min-height: 20px;
}

.chat-name {
    font-weight: 600;
    font-size: 16px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

.chat-status {
    font-size: 14px;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.verified-badge {
    display: inline-flex;
    align-items: center;
    flex-shrink: 0;
}

/* Сброс всех возможных трансформаций и смещений */
.chat-item * {
    transform: none !important;
    translate: none !important;
    margin-top: 0 !important;
    margin-bottom: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
}

/* Добавьте в CSS */
.group-info-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--card);
    z-index: 1001;
    overflow-y: auto;
    transition: all 0.3s ease;
    transform: translateX(0);
    opacity: 1;
}

.group-info-container.hidden {
    transform: translateX(100%);
    opacity: 0;
}

/* Анимация для плавного появления/исчезновения */
@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOutRight {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}

.group-info-container.slide-in {
    animation: slideInRight 0.3s ease-out;
}

.group-info-container.slide-out {
    animation: slideOutRight 0.3s ease-in;
}

/* Стили для аватара группы в информации */
#group-info-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 36px;
    font-weight: 600;
    margin-bottom: 16px;
    position: relative;
    overflow: hidden;
}

#group-avatar-text {
    font-weight: bold;
    font-size: 36px;
}

/* Анимация для плавного появления */
.group-info-container {
    animation: slideInRight 0.3s ease-out;
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Исправление для verified badge в списке чатов */
.chat-name-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
    min-height: 20px;
}

.chat-name {
    font-weight: 600;
    font-size: 16px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

.chat-info .verified-badge {
    display: inline-flex;
    align-items: center;
    flex-shrink: 0;
    margin-left: 0;
}

.chat-info .verified-badge lottie-player {
    width: 16px !important;
    height: 16px !important;
    margin: 0 !important;
}

/* Убедитесь, что контейнер чата правильно выровнен */
.chat-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background-color 0.2s;
    height: 72px;
    box-sizing: border-box;
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    margin-right: 12px;
    flex-shrink: 0;
    overflow: hidden;
}

.chat-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
}

.chat-status {
    font-size: 14px;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* ПОЛНОСТЬЮ ПЕРЕПИСАННЫЕ СТИЛИ ДЛЯ ЧАТ-ИTEMОВ */
.chat-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background-color 0.2s;
    min-height: 70px;
    box-sizing: border-box;
    width: 100%;
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    margin-right: 12px;
    flex-shrink: 0;
    overflow: hidden;
}

.chat-avatar.group-avatar {
    background: #666;
}

.chat-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

.avatar-text {
    font-weight: bold;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}

.chat-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* КОНТЕЙНЕР ДЛЯ ИМЕНИ И БЕЙДЖА */
.chat-name-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
    width: 100%;
    min-height: 20px;
}

/* ИМЯ ЧАТА - ЗАНИМАЕТ ВСЕ СВОБОДНОЕ МЕСТО */
.chat-name {
    font-weight: 600;
    font-size: 16px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

/* БЕЙДЖ ВЕРИФИКАЦИИ - ФИКСИРОВАННЫЙ РАЗМЕР */
.chat-info .verified-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    width: 16px;
    height: 16px;
    margin: 0;
    padding: 0;
}

.chat-info .verified-badge lottie-player {
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important;
    min-height: 16px !important;
    margin: 0 !important;
    padding: 0 !important;
}

.chat-status {
    font-size: 14px;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
}

/* СБРОС ВСЕХ ВОЗМОЖНЫХ КОНФЛИКТУЮЩИХ СТИЛЕЙ */
.chat-item * {
    transform: none !important;
    translate: none !important;
    margin-top: 0 !important;
    margin-bottom: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    line-height: normal !important;
}

.chat-name-wrapper * {
    vertical-align: middle !important;
    display: inline-flex !important;
    align-items: center !important;
}
</style>
<script>
/* ---------- Отключаем конфликтные стили ---------- */
const badRules = [
  'html, body { overflow: hidden; }',            /* скролл */
  '.message-bubble { border-radius: 18px; }',    /* скругление */
  '.message.incoming .message-bubble { background: var(--incoming-bubble); }',
  '.message.outgoing .message-bubble { background: var(--outgoing-bubble); }',
  'body { -webkit-user-select: none; }'          /* выделение текста */
];

const style = document.createElement('style');
style.id = 'fix-styles';
badRules.forEach(r => style.sheet.insertRule(r.replace(/;/g,' !important;')));
document.head.appendChild(style);
</script>

</body>
</html>